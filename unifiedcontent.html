<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unified Content Checker - Fixed Upload</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            color: white;
        }

        .header h1 {
            font-size: 3rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .tool-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            padding: 50px;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .input-tabs {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
            border-bottom: 3px solid #e2e8f0;
        }

        .input-tab {
            padding: 15px 30px;
            border: none;
            background: #f8fafc;
            color: #6b7280;
            font-weight: 600;
            cursor: pointer;
            border-radius: 15px 15px 0 0;
            transition: all 0.3s ease;
            font-size: 1rem;
            border-bottom: 3px solid transparent;
        }

        .input-tab:hover {
            background: #f1f5f9;
            color: #374151;
        }

        .input-tab.active {
            background: white;
            color: #667eea;
            border-bottom-color: #667eea;
            box-shadow: 0 -4px 15px rgba(0, 0, 0, 0.1);
        }

        .input-content {
            display: none;
        }

        .input-content.active {
            display: block;
            animation: fadeInUp 0.4s ease;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .input-group {
            margin-bottom: 25px;
        }

        .input-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 700;
            color: #4a5568;
            font-size: 1.1rem;
        }

        .input-group textarea {
            width: 100%;
            padding: 18px;
            border: 3px solid #e2e8f0;
            border-radius: 15px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: white;
            font-family: inherit;
            min-height: 140px;
            resize: vertical;
            line-height: 1.6;
        }

        .input-group textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.1);
        }

        .file-upload {
            border: 3px dashed #667eea;
            border-radius: 15px;
            padding: 40px;
            text-align: center;
            background: rgba(102, 126, 234, 0.05);
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .file-upload:hover {
            background: rgba(102, 126, 234, 0.1);
            border-color: #5a6fd8;
            transform: translateY(-2px);
        }

        .file-upload.dragover {
            background: rgba(102, 126, 234, 0.15);
            border-color: #4c63d2;
            transform: scale(1.02);
        }

        .file-upload-icon {
            font-size: 3rem;
            color: #667eea;
            margin-bottom: 15px;
        }

        .file-upload h3 {
            color: #4a5568;
            margin-bottom: 10px;
            font-size: 1.2rem;
        }

        .file-upload p {
            color: #718096;
            font-size: 1rem;
        }

        .char-counter {
            text-align: right;
            font-size: 0.95rem;
            color: #6b7280;
            margin-top: 8px;
            font-weight: 500;
        }

        .analyze-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 20px 50px;
            border-radius: 20px;
            font-size: 1.3rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.4s ease;
            width: 100%;
            margin-bottom: 40px;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }

        .analyze-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(102, 126, 234, 0.4);
        }

        .message {
            margin-top: 15px;
            padding: 15px;
            border-radius: 15px;
            font-weight: 600;
        }

        .message.success {
            background: rgba(0, 204, 68, 0.1);
            border-left: 4px solid #00cc44;
            color: #0d4718;
        }

        .message.error {
            background: rgba(239, 68, 68, 0.1);
            border-left: 4px solid #ef4444;
            color: #7f1d1d;
        }

        .message.info {
            background: rgba(102, 126, 234, 0.1);
            border-left: 4px solid #667eea;
            color: #364676;
        }

        .message.warning {
            background: rgba(255, 170, 0, 0.1);
            border-left: 4px solid #ffaa00;
            color: #856404;
        }

        .debug-info {
            margin-top: 10px;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 8px;
            font-family: monospace;
            font-size: 0.9rem;
            color: #495057;
        }

        #fileInputElement {
            display: none !important;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-shield-alt"></i> AI Detection & Plagiarism Checker</h1>
            <p>Enterprise AI-Powered Content Authenticity Platform</p>
            <div style="background: rgba(255, 255, 255, 0.2); backdrop-filter: blur(10px); padding: 8px 20px; border-radius: 25px; display: inline-block; font-weight: 600; font-size: 0.9rem; border: 1px solid rgba(255, 255, 255, 0.3);">
                <i class="fas fa-star"></i> Professional Grade Analysis
            </div>
        </div>

        <div class="tool-container">
            <div style="text-align: center; margin-bottom: 40px;">
                <h2 style="font-size: 2.8rem; color: #4a5568; margin-bottom: 15px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;"><i class="fas fa-search"></i> Content Authenticity Analysis</h2>
                <p style="font-size: 1.2rem; color: #718096; margin-bottom: 20px;">Six-dimensional AI detection & plagiarism verification platform</p>
            </div>

            <div style="background: linear-gradient(145deg, rgba(102, 126, 234, 0.1), rgba(102, 126, 234, 0.05)); border: 2px solid rgba(102, 126, 234, 0.2); border-radius: 15px; padding: 20px; margin-bottom: 30px; text-align: center; cursor: pointer; transition: all 0.3s ease;" onclick="toggleFeatures()">
                <h3 style="color: #667eea; margin-bottom: 10px; font-size: 1.3rem; font-weight: 700;">🚀 Our Six-Dimensional Analysis Platform</h3>
                <p style="color: #4a5568; margin-bottom: 15px; font-size: 1rem;">Click to explore our comprehensive authenticity verification capabilities</p>
                <span style="font-size: 1.5rem; color: #667eea;" id="featuresArrow">▼</span>
            </div>

            <div style="display: none; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;" id="featureHighlights">
                <div style="background: rgba(102, 126, 234, 0.1); padding: 15px; border-radius: 15px; text-align: center; transition: all 0.3s ease;">
                    <i class="fas fa-robot" style="font-size: 1.5rem; color: #667eea; margin-bottom: 8px;"></i>
                    <strong style="display: block; color: #4a5568; font-size: 0.9rem; margin-bottom: 5px;">AI Pattern Detection</strong>
                    <span style="color: #718096; font-size: 0.8rem;">Multi-model ensemble analysis</span>
                </div>
                <div style="background: rgba(102, 126, 234, 0.1); padding: 15px; border-radius: 15px; text-align: center; transition: all 0.3s ease;">
                    <i class="fas fa-copy" style="font-size: 1.5rem; color: #667eea; margin-bottom: 8px;"></i>
                    <strong style="display: block; color: #4a5568; font-size: 0.9rem; margin-bottom: 5px;">Plagiarism Verification</strong>
                    <span style="color: #718096; font-size: 0.8rem;">Cross-platform source checking</span>
                </div>
                <div style="background: rgba(102, 126, 234, 0.1); padding: 15px; border-radius: 15px; text-align: center; transition: all 0.3s ease;">
                    <i class="fas fa-chart-line" style="font-size: 1.5rem; color: #667eea; margin-bottom: 8px;"></i>
                    <strong style="display: block; color: #4a5568; font-size: 0.9rem; margin-bottom: 5px;">Linguistic Analysis</strong>
                    <span style="color: #718096; font-size: 0.8rem;">Deep language flow assessment</span>
                </div>
                <div style="background: rgba(102, 126, 234, 0.1); padding: 15px; border-radius: 15px; text-align: center; transition: all 0.3s ease;">
                    <i class="fas fa-file-alt" style="font-size: 1.5rem; color: #667eea; margin-bottom: 8px;"></i>
                    <strong style="display: block; color: #4a5568; font-size: 0.9rem; margin-bottom: 5px;">Document Processing</strong>
                    <span style="color: #718096; font-size: 0.8rem;">PDF, DOCX, TXT support</span>
                </div>
                <div style="background: rgba(102, 126, 234, 0.1); padding: 15px; border-radius: 15px; text-align: center; transition: all 0.3s ease;">
                    <i class="fas fa-database" style="font-size: 1.5rem; color: #667eea; margin-bottom: 8px;"></i>
                    <strong style="display: block; color: #4a5568; font-size: 0.9rem; margin-bottom: 5px;">Source Verification</strong>
                    <span style="color: #718096; font-size: 0.8rem;">Academic database integration</span>
                </div>
                <div style="background: rgba(102, 126, 234, 0.1); padding: 15px; border-radius: 15px; text-align: center; transition: all 0.3s ease;">
                    <i class="fas fa-shield-check" style="font-size: 1.5rem; color: #667eea; margin-bottom: 8px;"></i>
                    <strong style="display: block; color: #4a5568; font-size: 0.9rem; margin-bottom: 5px;">Authenticity Scoring</strong>
                    <span style="color: #718096; font-size: 0.8rem;">Professional grade metrics</span>
                </div>
            </div>

            <div style="display: flex; gap: 20px; justify-content: center; margin-bottom: 40px; flex-wrap: wrap;" class="tier-selector">
                <button style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-color: #667eea; color: white; border: 3px solid #667eea; font-weight: 600; cursor: pointer; border-radius: 20px; padding: 20px 35px; font-size: 1.1rem; position: relative; box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3); transform: translateY(-3px);" id="freeBtn" onclick="selectTier('free')">
                    🆓 Free Analysis
                    <span style="position: absolute; top: -8px; right: -8px; background: linear-gradient(45deg, #ff4444, #ff6b6b); color: white; font-size: 0.7rem; padding: 4px 8px; border-radius: 12px; font-weight: bold;">5 left</span>
                </button>
                <button style="background: linear-gradient(145deg, #f8fafc, #e2e8f0); color: #4a5568; border: 3px solid #e2e8f0; font-weight: 600; cursor: pointer; border-radius: 20px; padding: 20px 35px; font-size: 1.1rem; position: relative; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);" id="trialBtn" onclick="selectTier('trial')">
                    ⭐ Premium Trial
                    <span style="position: absolute; top: -8px; right: -8px; background: linear-gradient(45deg, #ff4444, #ff6b6b); color: white; font-size: 0.7rem; padding: 4px 8px; border-radius: 12px; font-weight: bold;">2 left</span>
                </button>
            </div>

            <div style="display: none; background: linear-gradient(135deg, rgba(255, 107, 107, 0.1), rgba(255, 142, 83, 0.1)); border: 2px solid rgba(255, 107, 107, 0.2); border-radius: 15px; padding: 20px; margin: 20px 0; text-align: center; cursor: pointer;" id="premiumToggle" onclick="togglePremiumFeatures()">
                <h4 style="color: #ff6b6b; margin-bottom: 10px; font-size: 1.3rem; font-weight: 700;">⭐ Premium Features Available</h4>
                <p style="color: #4a5568; margin-bottom: 15px; font-size: 1rem;">Click to see what's unlocked with Premium Trial</p>
                <span style="font-size: 1.5rem; color: #ff6b6b;" id="premiumArrow">▼</span>
            </div>

            <div style="display: none; background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1)); border: 2px solid rgba(102, 126, 234, 0.2); border-radius: 20px; padding: 25px; margin: 20px 0;" id="premiumPreview">
                <h4 style="color: #667eea; margin-bottom: 15px; font-size: 1.2rem;">🔥 Premium Features Unlocked:</h4>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px; margin-bottom: 15px;">
                    <div style="padding: 8px 0; color: #4a5568; font-weight: 500;">🔥 Advanced AI pattern detection</div>
                    <div style="padding: 8px 0; color: #4a5568; font-weight: 500;">🔥 Deep source verification databases</div>
                    <div style="padding: 8px 0; color: #4a5568; font-weight: 500;">🔥 Cross-platform plagiarism checking</div>
                    <div style="padding: 8px 0; color: #4a5568; font-weight: 500;">🔥 Technical linguistic analysis</div>
                    <div style="padding: 8px 0; color: #4a5568; font-weight: 500;">🔥 Comprehensive document processing</div>
                    <div style="padding: 8px 0; color: #4a5568; font-weight: 500;">🔥 Professional authenticity reports</div>
                </div>
            </div>
            <div class="input-section">
                <div class="input-tabs">
                    <button class="input-tab active" onclick="switchInputType('text')">📝 Paste Content</button>
                    <button class="input-tab" onclick="switchInputType('file')">📁 Upload Document</button>
                </div>
                
                <div class="input-content active" id="textInput">
                    <div style="margin-bottom: 20px; background: rgba(102, 126, 234, 0.05); padding: 15px; border-radius: 12px; border: 1px solid rgba(102, 126, 234, 0.1);">
                        <label style="font-size: 0.95rem; margin-bottom: 10px; font-weight: 600; color: #4a5568; display: block;">📚 Try Sample Content - Experience Our Analysis:</label>
                        <div>
                            <button style="background: linear-gradient(145deg, rgba(102, 126, 234, 0.1), rgba(102, 126, 234, 0.2)); border: 1px solid #667eea; color: #667eea; padding: 8px 12px; border-radius: 20px; font-size: 0.85rem; font-weight: 600; cursor: pointer; margin: 4px; transition: all 0.3s ease;" onclick="loadSample('ai_generated')">🤖 AI-Generated Text</button>
                            <button style="background: linear-gradient(145deg, rgba(102, 126, 234, 0.1), rgba(102, 126, 234, 0.2)); border: 1px solid #667eea; color: #667eea; padding: 8px 12px; border-radius: 20px; font-size: 0.85rem; font-weight: 600; cursor: pointer; margin: 4px; transition: all 0.3s ease;" onclick="loadSample('human_written')">✍️ Human-Written Content</button>
                            <button style="background: linear-gradient(145deg, rgba(102, 126, 234, 0.1), rgba(102, 126, 234, 0.2)); border: 1px solid #667eea; color: #667eea; padding: 8px 12px; border-radius: 20px; font-size: 0.85rem; font-weight: 600; cursor: pointer; margin: 4px; transition: all 0.3s ease;" onclick="loadSample('mixed_content')">🔀 Mixed Content</button>
                            <button style="background: linear-gradient(145deg, rgba(102, 126, 234, 0.1), rgba(102, 126, 234, 0.2)); border: 1px solid #667eea; color: #667eea; padding: 8px 12px; border-radius: 20px; font-size: 0.85rem; font-weight: 600; cursor: pointer; margin: 4px; transition: all 0.3s ease;" onclick="loadSample('academic_style')">🎓 Academic Writing</button>
                        </div>
                    </div>
                    
                    <div class="input-group">
                        <label for="content-text"><i class="fas fa-file-text"></i> Content for Authenticity Analysis</label>
                        <textarea id="content-text" placeholder="Paste your content here for comprehensive authenticity analysis...

Our unified system will analyze:
• AI generation patterns and signatures
• Plagiarism indicators and source matching
• Writing style authenticity and flow
• Linguistic patterns and consistency
• Content originality verification

Perfect for academic papers, articles, reports, and any written content." oninput="updateCharCount()"></textarea>
                        <div class="char-counter" id="charCounter">0 characters</div>
                    </div>
                </div>
                
                <div class="input-content" id="fileInput">
                    <div class="input-group">
                        <label><i class="fas fa-file-upload"></i> Document Upload</label>
                        <div class="file-upload" id="fileUpload">
                            <div class="file-upload-icon">📄</div>
                            <h3>Drop files here or click to upload</h3>
                            <p>Supports: TXT, PDF, DOCX files (max 10MB)</p>
                        </div>
                        <input type="file" id="fileInputElement" accept=".txt,.pdf,.docx">
                        <div id="uploadMessages"></div>
                    </div>
                </div>

                <button class="analyze-btn" onclick="analyzeContent()">
                    <i class="fas fa-search"></i> Launch Analysis
                </button>

                <div class="progress-container" id="progressContainer">
                    <div class="progress-text" id="progressText">Initializing Analysis...</div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    <div class="progress-details" id="progressDetails">Preparing systems...</div>
                </div>

                <div class="results" id="results">
                    <!-- Results will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let currentInputType = 'text';
        let currentTier = 'free';

        // Sample content for testing
        const sampleTexts = {
            ai_generated: "Furthermore, it is important to note that artificial intelligence represents a paradigm shift in how we approach content creation. Moreover, this innovative technology leverages advanced algorithms to optimize the writing process. Additionally, comprehensive studies indicate that these cutting-edge solutions provide significant benefits across multiple industries. In conclusion, the implementation of AI-driven systems streamlines operations and enhances productivity.",
            
            human_written: "I can't believe what happened today! So I was walking to the coffee shop around the corner from my apartment, and I see this guy just standing there with like 20 dogs. Twenty! I'm not even exaggerating. Some were huge German Shepherds, others were tiny Chihuahuas, and they were all just chilling together. Turns out he runs a dog-walking service and was doing a group walk. Made my morning honestly - sometimes you just need to see something that makes you smile.",
            
            mixed_content: "According to recent studies, machine learning algorithms have demonstrated significant improvements in natural language processing tasks. However, I've personally noticed that when I use AI writing tools, the output often feels somewhat robotic and lacks the personal touch that makes writing engaging. The technology is impressive, don't get me wrong, but there's still something special about human creativity that can't be replicated.",
            
            academic_style: "The present study examines the efficacy of automated content detection systems in identifying artificially generated text. Through a comprehensive analysis of linguistic patterns, syntactic structures, and semantic coherence, we demonstrate that current detection methodologies achieve approximately 85% accuracy rates. These findings have significant implications for academic integrity and content verification processes in digital environments."
        };
        
        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Page loaded, initializing upload...');
            initializeFileUpload();
        });

        function toggleFeatures() {
            const featureHighlights = document.getElementById('featureHighlights');
            const arrow = document.getElementById('featuresArrow');
            
            if (featureHighlights.style.display === 'none') {
                featureHighlights.style.display = 'grid';
                arrow.textContent = '▲';
            } else {
                featureHighlights.style.display = 'none';
                arrow.textContent = '▼';
            }
        }

        function togglePremiumFeatures() {
            const premiumPreview = document.getElementById('premiumPreview');
            const arrow = document.getElementById('premiumArrow');
            
            if (premiumPreview.style.display === 'none') {
                premiumPreview.style.display = 'block';
                arrow.textContent = '▲';
            } else {
                premiumPreview.style.display = 'none';
                arrow.textContent = '▼';
            }
        }

        function selectTier(tier) {
            currentTier = tier;
            
            // Update button styles
            const freeBtn = document.getElementById('freeBtn');
            const trialBtn = document.getElementById('trialBtn');
            const premiumToggle = document.getElementById('premiumToggle');
            
            if (tier === 'free') {
                freeBtn.style.background = 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)';
                freeBtn.style.color = 'white';
                freeBtn.style.borderColor = '#667eea';
                freeBtn.style.transform = 'translateY(-3px)';
                freeBtn.style.boxShadow = '0 8px 25px rgba(102, 126, 234, 0.3)';
                
                trialBtn.style.background = 'linear-gradient(145deg, #f8fafc, #e2e8f0)';
                trialBtn.style.color = '#4a5568';
                trialBtn.style.borderColor = '#e2e8f0';
                trialBtn.style.transform = 'none';
                trialBtn.style.boxShadow = '0 4px 15px rgba(0, 0, 0, 0.1)';
                
                premiumToggle.style.display = 'none';
            } else {
                trialBtn.style.background = 'linear-gradient(135deg, #ff6b6b 0%, #ff8e53 100%)';
                trialBtn.style.color = 'white';
                trialBtn.style.borderColor = '#ff6b6b';
                trialBtn.style.transform = 'translateY(-3px)';
                trialBtn.style.boxShadow = '0 8px 25px rgba(255, 107, 107, 0.3)';
                
                freeBtn.style.background = 'linear-gradient(145deg, #f8fafc, #e2e8f0)';
                freeBtn.style.color = '#4a5568';
                freeBtn.style.borderColor = '#e2e8f0';
                freeBtn.style.transform = 'none';
                freeBtn.style.boxShadow = '0 4px 15px rgba(0, 0, 0, 0.1)';
                
                premiumToggle.style.display = 'block';
            }

            // Update analyze button
            const analyzeBtn = document.querySelector('.analyze-btn');
            if (tier === 'free') {
                analyzeBtn.innerHTML = '<i class="fas fa-search"></i> Launch Professional Analysis (FREE)';
                analyzeBtn.style.background = 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)';
            } else {
                analyzeBtn.innerHTML = '<i class="fas fa-star"></i> Launch Premium Analysis (TRIAL)';
                analyzeBtn.style.background = 'linear-gradient(135deg, #ff6b6b 0%, #ff8e53 100%)';
            }
        }

        function loadSample(type) {
            const textarea = document.getElementById('content-text');
            textarea.value = sampleTexts[type];
            updateCharCount();
            
            if (currentInputType !== 'text') {
                switchInputType('text');
            }
        }

        function switchInputType(type) {
            console.log('Switching to:', type);
            currentInputType = type;
            
            // Update tabs
            document.querySelectorAll('.input-tab').forEach((tab, index) => {
                tab.classList.remove('active');
                if ((type === 'text' && index === 0) || (type === 'file' && index === 1)) {
                    tab.classList.add('active');
                }
            });
            
            // Update content
            document.querySelectorAll('.input-content').forEach(content => {
                content.classList.remove('active');
            });
            
            const targetContent = document.getElementById(type + 'Input');
            if (targetContent) {
                setTimeout(() => {
                    targetContent.classList.add('active');
                }, 150);
            }
        }

        function updateCharCount() {
            const textarea = document.getElementById('content-text');
            const counter = document.getElementById('charCounter');
            const length = textarea.value.length;
            
            counter.textContent = `${length.toLocaleString()} characters`;
            
            if (length > 5000) {
                counter.className = 'char-counter error';
                counter.textContent += ' (⚠️ Too long)';
            } else if (length > 100) {
                counter.className = 'char-counter';
                counter.textContent += ' (✅ Good length)';
            } else {
                counter.className = 'char-counter';
            }
        }

        function initializeFileUpload() {
            const fileUploadArea = document.getElementById('fileUpload');
            const fileInputElement = document.getElementById('fileInputElement');
            
            console.log('File upload area:', fileUploadArea);
            console.log('File input element:', fileInputElement);
            
            if (!fileUploadArea || !fileInputElement) {
                console.error('File upload elements not found!');
                showMessage('error', 'Upload interface initialization failed');
                return;
            }

            // Click handler for upload area
            fileUploadArea.addEventListener('click', function(e) {
                e.preventDefault();
                console.log('Upload area clicked');
                showMessage('info', 'Opening file picker...');
                fileInputElement.click();
            });

            // File selection handler
            fileInputElement.addEventListener('change', function(e) {
                console.log('File input changed:', e.target.files);
                if (e.target.files && e.target.files.length > 0) {
                    handleFileUpload(e);
                }
            });

            // Drag and drop handlers
            fileUploadArea.addEventListener('dragover', function(e) {
                e.preventDefault();
                e.stopPropagation();
                fileUploadArea.classList.add('dragover');
                console.log('Drag over');
            });

            fileUploadArea.addEventListener('dragleave', function(e) {
                e.preventDefault();
                e.stopPropagation();
                fileUploadArea.classList.remove('dragover');
                console.log('Drag leave');
            });

            fileUploadArea.addEventListener('drop', function(e) {
                e.preventDefault();
                e.stopPropagation();
                fileUploadArea.classList.remove('dragover');
                console.log('Drop event:', e.dataTransfer.files);
                
                if (e.dataTransfer.files && e.dataTransfer.files.length > 0) {
                    // Simulate file input event
                    const fakeEvent = {
                        target: {
                            files: e.dataTransfer.files
                        }
                    };
                    handleFileUpload(fakeEvent);
                }
            });

            console.log('File upload initialized successfully');
            showMessage('success', 'Upload interface ready');
        }

        async function handleFileUpload(event) {
            const file = event.target.files[0];
            if (!file) {
                console.log('No file selected');
                return;
            }

            console.log('Processing file:', {
                name: file.name,
                type: file.type,
                size: file.size
            });

            // Show file info
            showFileInfo(file);

            // Validate file
            if (file.size > 10 * 1024 * 1024) {
                showMessage('error', 'File too large! Please choose a file smaller than 10MB.');
                return;
            }

            const allowedTypes = ['text/plain', 'application/pdf', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'];
            const isValidType = allowedTypes.includes(file.type) || file.name.match(/\.(txt|pdf|docx)$/i);
            
            if (!isValidType) {
                showMessage('error', 'Unsupported file type! Please choose TXT, PDF, or DOCX files.');
                return;
            }

            // Show processing message
            showMessage('warning', `Processing "${file.name}"... Please wait.`);

            try {
                // Create FormData
                const formData = new FormData();
                formData.append('file', file);

                console.log('Sending request to backend...');

                const response = await fetch('https://ai-detector-backend-g4mj.onrender.com/api/extract-text', {
                    method: 'POST',
                    body: formData
                });

                console.log('Response received:', {
                    status: response.status,
                    statusText: response.statusText,
                    ok: response.ok
                });

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }

                const data = await response.json();
                console.log('Response data:', data);
                
                if (data.error) {
                    throw new Error(data.error);
                }

                // Success! Load the extracted text
                const textarea = document.getElementById('content-text');
                textarea.value = data.text || '';
                updateCharCount();
                
                // Switch to text tab
                switchInputType('text');
                
                showMessage('success', `✅ Successfully processed "${data.filename || file.name}"! ${data.text?.length || 0} characters extracted.`);

            } catch (error) {
                console.error('Upload error:', error);
                
                // Try fallback for TXT files
                if (file.name.toLowerCase().endsWith('.txt')) {
                    console.log('Trying fallback for TXT file...');
                    try {
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            const textarea = document.getElementById('content-text');
                            textarea.value = e.target.result;
                            updateCharCount();
                            switchInputType('text');
                            showMessage('success', `✅ TXT file loaded successfully! ${e.target.result.length} characters.`);
                        };
                        reader.onerror = function() {
                            showMessage('error', 'Failed to read file locally.');
                        };
                        reader.readAsText(file);
                        return;
                    } catch (fallbackError) {
                        console.error('Fallback failed:', fallbackError);
                    }
                }
                
                showMessage('error', `❌ Upload failed: ${error.message}`);
                
                // Show debug info
                showDebugInfo({
                    filename: file.name,
                    filesize: file.size,
                    filetype: file.type,
                    error: error.message,
                    timestamp: new Date().toISOString()
                });
            }
        }

        function showMessage(type, text) {
            const container = document.getElementById('uploadMessages');
            const message = document.createElement('div');
            message.className = `message ${type}`;
            message.innerHTML = `<strong>${type.toUpperCase()}:</strong> ${text}`;
            
            // Clear previous messages of same type
            const existing = container.querySelector(`.message.${type}`);
            if (existing) existing.remove();
            
            container.appendChild(message);
            
            // Auto-remove info messages after 5 seconds
            if (type === 'info') {
                setTimeout(() => {
                    if (message.parentNode) message.remove();
                }, 5000);
            }
        }

        function showFileInfo(file) {
            const sizeKB = (file.size / 1024).toFixed(1);
            showMessage('info', `Selected: ${file.name} (${sizeKB} KB, ${file.type || 'unknown type'})`);
        }

        function showDebugInfo(data) {
            const container = document.getElementById('uploadMessages');
            const debug = document.createElement('div');
            debug.className = 'debug-info';
            debug.innerHTML = `<strong>Debug Info:</strong><br>${JSON.stringify(data, null, 2)}`;
            container.appendChild(debug);
        }

        function analyzeContent() {
            var textInput = document.getElementById('content-text');
            if (!textInput) {
                alert('Please enter some text to analyze or upload a document.');
                return;
            }
            
            var text = textInput.value.trim();
            if (!text) {
                alert('Please enter some text to analyze or upload a document.');
                return;
            }

            if (text.length < 50) {
                alert('Please enter at least 50 characters for accurate analysis.');
                return;
            }

            var analyzeBtn = document.querySelector('.analyze-btn');
            if (analyzeBtn) {
                analyzeBtn.disabled = true;
                analyzeBtn.innerHTML = '🔬 Analyzing...';
            }

            showProgress();
            var resultsDiv = document.getElementById('results');
            if (resultsDiv) resultsDiv.style.display = 'none';

            // Enhanced progress simulation
            setTimeout(function() {
                updateProgress(20, '🤖 AI Content Analysis...', 'Running detection algorithms');
                setTimeout(function() {
                    updateProgress(50, '🔍 Plagiarism Check...', 'Checking sources');
                    setTimeout(function() {
                        updateProgress(80, '📊 Analysis Complete...', 'Generating results');
                        setTimeout(function() {
                            updateProgress(100, '✅ Done!', 'Results ready');
                            setTimeout(function() {
                                hideProgress();
                                showEnhancedResults(text);
                                if (analyzeBtn) {
                                    analyzeBtn.disabled = false;
                                    analyzeBtn.innerHTML = currentTier === 'free' ? 
                                        '<i class="fas fa-search"></i> Launch Professional Analysis (FREE)' : 
                                        '<i class="fas fa-star"></i> Launch Premium Analysis (TRIAL)';
                                }
                            }, 500);
                        }, 800);
                    }, 1000);
                }, 1000);
            }, 500);
        }
    </script>
</body>
</html>
