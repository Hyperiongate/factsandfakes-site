<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Facts & Fakes AI - Premium News Analysis</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 50%, #f8fafc 100%);
            color: #1e293b;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Navigation */
        .nav-header {
            background: white;
            padding: 15px 0;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }

        .nav-container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: 800;
            color: #667eea;
        }

        .nav-links {
            display: flex;
            gap: 30px;
            list-style: none;
        }

        .nav-links a {
            text-decoration: none;
            color: #374151;
            font-weight: 500;
            padding: 8px 16px;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .nav-links a:hover {
            background: #f3f4f6;
            color: #667eea;
        }

        .nav-links a.active {
            background: #667eea;
            color: white;
        }

        /* PROFESSIONAL BUTTON STYLING */
        .tier-btn, .analyze-btn, .compare-btn, .unlock-btn {
            background: #374151 !important;
            color: #ffffff !important;
            border: 2px solid #374151 !important;
            font-weight: 600 !important;
            cursor: pointer !important;
            transition: all 0.3s ease !important;
            border-radius: 12px !important;
            padding: 14px 28px !important;
            font-size: 1rem !important;
        }

        .tier-btn:hover, .analyze-btn:hover, .compare-btn:hover, .unlock-btn:hover {
            background: #4b5563 !important;
            border-color: #4b5563 !important;
            transform: translateY(-1px) !important;
        }

        .tier-btn.active {
            background: #667eea !important;
            border-color: #667eea !important;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3) !important;
        }

        .analyze-btn:disabled {
            opacity: 0.4 !important;
            cursor: not-allowed !important;
            transform: none !important;
            background: #6b7280 !important;
            border-color: #6b7280 !important;
            color: #ffffff !important;
        }        
        
        .tier-btn:disabled {
            opacity: 0.4 !important;
            cursor: not-allowed !important;
            background: #6b7280 !important;
            color: #ffffff !important;
            border-color: #6b7280 !important;
        }

        /* PROFESSIONAL TAB BUTTONS */
        .input-tab {
            padding: 12px 24px !important;
            border: none !important;
            background: #f8fafc !important;
            color: #6b7280 !important;
            font-weight: 600 !important;
            cursor: pointer !important;
            border-radius: 12px 12px 0 0 !important;
            transition: all 0.3s ease !important;
            font-size: 0.95rem !important;
            border-bottom: 3px solid transparent !important;
        }

        .input-tab:hover {
            background: #f1f5f9 !important;
            color: #374151 !important;
        }

        .input-tab.active {
            background: white !important;
            color: #667eea !important;
            border-bottom-color: #667eea !important;
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1) !important;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px 20px;
            background: linear-gradient(45deg, #667eea 0%, #764ba2 100%);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(102, 126, 234, 0.2);
            position: relative;
            color: white;
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 800;
            color: white;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
            font-weight: 300;
            color: white;
        }

        .usage-tracker {
            position: absolute;
            top: 15px;
            right: 20px;
            background: rgba(255, 255, 255, 0.9);
            color: #1e293b;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .usage-count {
            font-weight: 600;
            font-size: 0.85rem;
        }

        .usage-reset {
            font-size: 0.75rem;
            opacity: 0.7;
            margin-top: 2px;
        }

        .tier-selector {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .tier-badge {
            position: absolute;
            top: -8px;
            right: -8px;
            background: #ff4444;
            color: white;
            font-size: 0.7rem;
            padding: 2px 6px;
            border-radius: 10px;
            font-weight: bold;
        }

        .input-section {
            background: white;
            padding: 30px;
            border-radius: 20px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            border: 1px solid #e2e8f0;
        }

        .input-group {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        label {
            font-weight: 600;
            font-size: 1.1rem;
            color: #374151;
        }

        .input-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 2px solid #e2e8f0;
        }

        .input-content {
            display: none;
        }

        .input-content.active {
            display: block;
        }

        textarea, input[type="url"] {
            width: 100%;
            padding: 20px;
            border: 2px solid #e2e8f0;
            border-radius: 15px;
            background: white;
            color: #1e293b;
            font-size: 16px;
            transition: all 0.3s ease;
            font-family: inherit;
        }

        textarea {
            resize: none;
            height: 200px;
            overflow-y: auto;
        }

        textarea:focus, input[type="url"]:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.1);
        }

        input[type="url"] {
            height: 60px;
        }

        .analyze-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        /* ENHANCED FANCY PROGRESS BAR */
        .progress-container {
            display: none;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 50px;
            border-radius: 25px;
            margin: 40px 0;
            box-shadow: 
                0 25px 60px rgba(102, 126, 234, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            border: 3px solid rgba(255, 255, 255, 0.1);
            position: relative;
            z-index: 100;
            color: white;
            overflow: hidden;
        }

        .progress-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            animation: progress-shimmer 3s infinite;
        }

        @keyframes progress-shimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .progress-text {
            text-align: center;
            font-weight: 700;
            color: white;
            margin-bottom: 25px;
            font-size: 1.6rem;
            text-shadow: 
                0 2px 4px rgba(0, 0, 0, 0.3),
                0 0 20px rgba(255, 255, 255, 0.3);
            position: relative;
            z-index: 2;
        }

        .progress-bar {
            width: 100%;
            height: 24px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 15px;
            overflow: hidden;
            margin-bottom: 30px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            position: relative;
            box-shadow: 
                inset 0 2px 4px rgba(0, 0, 0, 0.3),
                0 0 20px rgba(255, 255, 255, 0.1);
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, 
                #00ff88 0%, 
                #00cc44 25%, 
                #ffaa00 50%, 
                #ff6600 75%, 
                #ff0066 100%);
            border-radius: 15px;
            transition: width 1.2s cubic-bezier(0.4, 0, 0.2, 1);
            width: 0%;
            position: relative;
            box-shadow: 
                0 0 25px rgba(0, 255, 136, 0.6),
                inset 0 2px 0 rgba(255, 255, 255, 0.3);
            overflow: hidden;
        }

        .progress-fill::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255,255,255,0.5), 
                transparent);
            animation: progress-wave 1.8s infinite;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 2px;
            left: 2px;
            right: 2px;
            height: 8px;
            background: linear-gradient(90deg, 
                rgba(255,255,255,0.9), 
                rgba(255,255,255,0.3));
            border-radius: 10px;
        }

        @keyframes progress-wave {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .progress-details {
            text-align: center;
            font-size: 1.2rem;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 20px;
            font-weight: 500;
            position: relative;
            z-index: 2;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
        }

        .progress-timer {
            text-align: center;
            font-size: 1.1rem;
            color: #ffeb3b;
            margin-top: 20px;
            font-weight: 600;
            background: rgba(255, 235, 59, 0.1);
            padding: 12px 20px;
            border-radius: 15px;
            border: 1px solid rgba(255, 235, 59, 0.3);
            position: relative;
            z-index: 2;
        }

        .loading-spinner {
            width: 80px;
            height: 80px;
            border: 8px solid rgba(255, 255, 255, 0.2);
            border-left: 8px solid #00ff88;
            border-top: 8px solid #ffaa00;
            border-radius: 50%;
            animation: enhanced-spin 1.5s linear infinite;
            margin: 30px auto;
            box-shadow: 
                0 0 40px rgba(0, 255, 136, 0.4),
                inset 0 0 20px rgba(255, 255, 255, 0.1);
            position: relative;
            z-index: 2;
        }

        .loading-spinner::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 40px;
            height: 40px;
            border: 4px solid transparent;
            border-top: 4px solid #ffffff;
            border-radius: 50%;
            transform: translate(-50%, -50%);
            animation: enhanced-spin 0.8s linear infinite reverse;
        }

        @keyframes enhanced-spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .progress-stage-indicator {
            display: flex;
            justify-content: space-between;
            margin: 20px 0;
            position: relative;
            z-index: 2;
        }

        .stage-dot {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transition: all 0.3s ease;
            position: relative;
        }

        .stage-dot.active {
            background: #00ff88;
            box-shadow: 0 0 15px rgba(0, 255, 136, 0.6);
        }

        .stage-dot.completed {
            background: #ffffff;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.4);
        }

        .results-container {
            display: none;
        }

        .comparison-view {
            display: none;
            gap: 20px;
            margin-top: 30px;
        }

        .comparison-side {
            flex: 1;
            background: white;
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            border: 1px solid #e2e8f0;
            position: relative;
        }

        .comparison-header {
            text-align: center;
            margin-bottom: 20px;
            padding: 15px;
            border-radius: 15px;
            font-weight: 700;
            font-size: 1.2rem;
        }

        .free-header {
            background: rgba(255, 170, 0, 0.2);
            border: 2px solid #ffaa00;
            color: #ffaa00;
        }

        .premium-header {
            background: rgba(102, 126, 234, 0.2);
            border: 2px solid #667eea;
            color: #667eea;
        }

        .feature-list {
            list-style: none;
            margin: 20px 0;
        }

        .feature-list li {
            padding: 8px 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .feature-included {
            color: #00cc44;
        }

        .feature-excluded {
            color: #ff4444;
            opacity: 0.6;
        }

        .executive-summary {
            background: white;
            padding: 30px;
            border-radius: 20px;
            border: 1px solid #e2e8f0;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .credibility-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .credibility-score {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .score-circle {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: 800;
            position: relative;
            overflow: hidden;
        }

        .assessment-text {
            font-size: 1.3rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .grade-badge {
            background: rgba(255, 255, 255, 0.1);
            padding: 8px 16px;
            border-radius: 25px;
            font-weight: 700;
            font-size: 1.1rem;
        }

        .analysis-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 25px;
            margin-top: 30px;
        }

        .analysis-card {
            background: white;
            border-radius: 20px;
            padding: 25px;
            border: 1px solid #e2e8f0;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            position: relative;
        }

        .analysis-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        }

        .card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .card-title {
            font-size: 1.3rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
            color: #1e293b;
        }

        .card-icon {
            width: 24px;
            height: 24px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }

        .premium-lock {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
            border-radius: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            z-index: 10;
            color: white;
        }

        .lock-icon {
            font-size: 3rem;
            margin-bottom: 15px;
            opacity: 0.8;
        }

        .lock-text {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .metric-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 15px 0;
            color: #374151;
        }

        .metric-bar {
            background: #e2e8f0;
            height: 8px;
            border-radius: 10px;
            margin: 10px 0;
            overflow: hidden;
        }

        .metric-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            border-radius: 10px;
            transition: width 0.8s ease;
        }

        .bias-meter {
            position: relative;
            height: 40px;
            background: linear-gradient(90deg, #0066cc 0%, #4488cc 25%, #cccccc 50%, #cc8888 75%, #cc0000 100%);
            border-radius: 20px;
            margin: 15px 0;
            overflow: hidden;
        }

        .bias-indicator {
            position: absolute;
            top: -10px;
            width: 20px;
            height: 60px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            transition: left 0.5s ease;
        }

        .bias-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .upgrade-banner {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            margin: 20px 0;
            display: none;
        }

        .error-message {
            background: #fef2f2;
            border: 1px solid #fecaca;
            color: #dc2626;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            text-align: center;
        }

        .fade-in {
            animation: fadeIn 0.8s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Conversational Analysis Display */
        .conversation-bubble {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);
            padding: 25px;
            border-radius: 20px;
            margin: 20px 0;
            border-left: 5px solid #667eea;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.1);
        }

        .conversation-bubble h4 {
            color: #667eea;
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .conversation-bubble p {
            font-size: 1.1rem;
            line-height: 1.7;
            color: #374151;
            margin-bottom: 15px;
        }

        .conversation-bubble .key-point {
            background: rgba(102, 126, 234, 0.1);
            padding: 15px;
            border-radius: 12px;
            margin: 10px 0;
            border-left: 3px solid #667eea;
        }

        @media (max-width: 768px) {
            .header h1 { font-size: 2rem; }
            .analysis-grid { grid-template-columns: 1fr; }
            .credibility-header { flex-direction: column; }
            .container { padding: 15px; }
            .comparison-view { flex-direction: column; }
            .usage-tracker { 
                position: relative; 
                margin: 15px auto 0; 
                display: block;
                text-align: center;
            }
            .nav-links {
                gap: 15px;
                flex-wrap: wrap;
            }
            .nav-links a {
                font-size: 0.9rem;
                padding: 6px 12px;
            }
            .nav-container {
                flex-direction: column;
                gap: 15px;
            }
            .progress-container {
                padding: 30px 20px;
            }
            .loading-spinner {
                width: 60px;
                height: 60px;
            }
        }
    </style>
</head>
<body>
    <nav class="nav-header">
        <div class="nav-container">
            <div class="logo">Facts & Fakes AI</div>
            <ul class="nav-links">
                <li><a href="/" >Home</a></li>
                <li><a href="/news.html" class="active">News Misinformation</a></li>
                <li><a href="/deepfakes.html">DeepFakes</a></li>
                <li><a href="/ai-content.html">AI Content Analysis</a></li>
                <li><a href="/conspiracy.html">Conspiracy Theory Analysis</a></li>
            </ul>
        </div>
    </nav>

    <div class="container">
        <div class="header">
            <div class="usage-tracker" id="usageTracker">
                <div class="usage-count" id="usageCount">Free: 3/3 today</div>
                <div class="usage-reset" id="usageReset">Resets in 12h 45m</div>
            </div>
            <h1>Facts & Fakes AI</h1>
            <p>Premium News Misinformation Analysis</p>
        </div>

        <div class="tier-selector">
            <button class="tier-btn active" id="freeBtn" onclick="selectTier('free')">
                🆓 Free Analysis
                <span class="tier-badge" id="freeBadge">2 left</span>
            </button>
            <button class="tier-btn" id="trialBtn" onclick="selectTier('trial')">
                ⭐ Try Premium
                <span class="tier-badge" id="trialBadge">1 left</span>
            </button>
        </div>

        <div class="input-section">
            <div class="input-group">
                <label>Choose Analysis Method</label>
                <div class="input-tabs">
                    <button class="input-tab active" onclick="switchInputType('text')">📝 Paste Text</button>
                    <button class="input-tab" onclick="switchInputType('url')">🔗 Analyze URL</button>
                </div>
                
                <div class="input-content active" id="textInput">
                    <textarea 
                        id="newsText" 
                        placeholder="Paste the news article, headline, or claim you want to analyze for misinformation, bias, and credibility..."
                    ></textarea>
                </div>
                
                <div class="input-content" id="urlInput">
                    <input 
                        type="url" 
                        id="newsUrl" 
                        placeholder="https://example.com/news-article"
                    />
                    <small style="color: #6b7280; margin-top: 5px; display: block;">
                        Enter a news article URL to automatically extract and analyze content
                    </small>
                </div>
                
                <div class="analyze-controls">
                    <button class="analyze-btn" id="analyzeBtn" onclick="startAnalysis()">
                        🚀 ANALYZE NEWS
                    </button>
                    <button class="compare-btn" onclick="showComparison()">
                        ⚖️ SEE THE DIFFERENCE
                    </button>
                </div>
            </div>
        </div>

        <div class="progress-container" id="progressContainer">
            <div class="progress-text" id="progressText">Initializing AI Analysis...</div>
            <div class="progress-stage-indicator" id="stageIndicator">
                <div class="stage-dot" data-stage="0"></div>
                <div class="stage-dot" data-stage="1"></div>
                <div class="stage-dot" data-stage="2"></div>
                <div class="stage-dot" data-stage="3"></div>
                <div class="stage-dot" data-stage="4"></div>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="progress-details" id="progressDetails">Starting analysis...</div>
            <div class="progress-timer" id="progressTimer"></div>
            <div class="loading-spinner"></div>
        </div>

        <div class="upgrade-banner" id="upgradeBanner">
            <h3>🚀 You've used all your free analyses today!</h3>
            <p>Upgrade to Premium for unlimited access and advanced features</p>
            <button onclick="showUpgradeOptions()">Upgrade Now - $9.99/month</button>
        </div>

        <div class="comparison-view" id="comparisonView">
            <div class="comparison-side">
                <div class="comparison-header free-header">
                    🆓 FREE VERSION
                </div>
                <ul class="feature-list">
                    <li><span class="feature-included">✓</span> Basic credibility score</li>
                    <li><span class="feature-included">✓</span> Simple AI summary</li>
                    <li><span class="feature-included">✓</span> 1-2 source verification</li>
                    <li><span class="feature-excluded">✗</span> Political bias analysis</li>
                    <li><span class="feature-excluded">✗</span> Author credibility profiling</li>
                    <li><span class="feature-excluded">✗</span> Cross-platform analysis</li>
                    <li><span class="feature-excluded">✗</span> Detailed breakdowns</li>
                    <li><span class="feature-excluded">✗</span> Professional reporting</li>
                </ul>
                <div id="freeResults" class="analysis-preview">
                    <div style="text-align: center; padding: 40px; opacity: 0.7;">
                        <div style="font-size: 2rem; margin-bottom: 10px;">73</div>
                        <div>Basic Credibility Score</div>
                        <div style="margin-top: 20px; font-size: 0.9rem;">
                            "This content appears to have moderate credibility based on basic analysis."
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="comparison-side">
                <div class="comparison-header premium-header">
                    💎 PREMIUM VERSION
                </div>
                <ul class="feature-list">
                    <li><span class="feature-included">✓</span> Advanced credibility scoring</li>
                    <li><span class="feature-included">✓</span> Comprehensive AI analysis</li>
                    <li><span class="feature-included">✓</span> 5-8 source verification</li>
                    <li><span class="feature-included">✓</span> Political bias meter</li>
                    <li><span class="feature-included">✓</span> Author credibility profiling</li>
                    <li><span class="feature-included">✓</span> Cross-platform analysis</li>
                    <li><span class="feature-included">✓</span> Interactive expandable sections</li>
                    <li><span class="feature-included">✓</span> Professional executive summary</li>
                </ul>
                <div id="premiumResults" class="analysis-preview">
                    <div style="text-align: center; padding: 20px;">
                        <div style="display: flex; align-items: center; gap: 15px; justify-content: center; margin-bottom: 15px;">
                            <div style="font-size: 2rem; font-weight: bold;">73.4</div>
                            <div style="background: #88cc00; padding: 4px 12px; border-radius: 15px; font-size: 0.9rem;">Grade: B</div>
                        </div>
                        <div style="font-size: 0.9rem; margin-bottom: 15px;">
                            MODERATE CREDIBILITY: This content shows relatively neutral language patterns. Analysis verified through 6 sources.
                        </div>
                        <div style="background: rgba(255,255,255,0.1); padding: 10px; border-radius: 10px; margin: 10px 0;">
                            Political Bias: Center-Left (-12)
                        </div>
                        <div style="background: rgba(255,255,255,0.1); padding: 10px; border-radius: 10px; margin: 10px 0;">
                            Author Credibility: 84/100
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="results-container" id="resultsContainer">
            <!-- Dynamic content will be inserted here -->
        </div>

        <div class="error-message" id="errorMessage" style="display: none;">
            <!-- Error messages will appear here -->
        </div>
    </div>

    <script>
        // Usage tracking system
        class UsageTracker {
            constructor() {
                // DISABLED FOR TESTING - Always allow usage
                this.usage = {
                    date: new Date().toDateString(),
                    freeUsed: 0,
                    trialUsed: false,
                    lastReset: Date.now()
                };
                this.updateDisplay();
            }

            canUseFree() {
                return true; // Always allow for testing
            }

            canUseTrial() {
                return true; // Always allow for testing
            }

            useFree() {
                // Don't actually consume usage during testing
                this.updateDisplay();
                return true;
            }

            useTrial() {
                // Don't actually consume usage during testing
                this.updateDisplay();
                return true;
            }

            saveUsage() {
                // Don't save during testing
            }

            updateDisplay() {
                // Show testing mode
                document.getElementById('usageCount').textContent = `Testing Mode`;
                document.getElementById('freeBadge').textContent = `∞`;
                document.getElementById('trialBadge').textContent = `∞`;

                // Enable all buttons
                document.getElementById('freeBtn').disabled = false;
                document.getElementById('trialBtn').disabled = false;

                document.getElementById('usageReset').textContent = 'Unlimited for testing';
            }

            updateResetTimer() {
                // No timer needed during testing
            }

            startResetTimer() {
                // No timer needed during testing
            }
        }

        // Global variables
        const usageTracker = new UsageTracker();
        let currentTier = 'free';
        let analysisData = null;
        let currentInputType = 'text';
        let analysisStartTime = null;
        let currentStage = 0;

        // Input type switching
        function switchInputType(type) {
            console.log('🔄 Switching to input type:', type);
            currentInputType = type;
            
            // Update tabs - remove active from all, add to clicked
            document.querySelectorAll('.input-tab').forEach((tab, index) => {
                tab.classList.remove('active');
                if ((type === 'text' && index === 0) || (type === 'url' && index === 1)) {
                    tab.classList.add('active');
                    console.log('✅ Tab activated:', tab.textContent);
                }
            });
            
            // Update content - hide all, show selected
            document.querySelectorAll('.input-content').forEach(content => {
                content.classList.remove('active');
            });
            
            const targetContent = document.getElementById(type + 'Input');
            if (targetContent) {
                targetContent.classList.add('active');
                console.log('✅ Content switched to:', type);
            } else {
                console.error('❌ Could not find content element:', type + 'Input');
            }
        }

        // Tier selection
        function selectTier(tier) {
            console.log('🎯 Selecting tier:', tier);
            currentTier = tier;
            
            // Update button states
            document.querySelectorAll('.tier-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById(tier + 'Btn').classList.add('active');

            // Update analyze button text
            const analyzeBtn = document.getElementById('analyzeBtn');
            if (tier === 'free') {
                analyzeBtn.textContent = '🚀 ANALYZE NEWS (FREE)';
            } else {
                analyzeBtn.textContent = '⭐ TRY PREMIUM ANALYSIS';
            }
            
            console.log('✅ Tier selected:', tier);
        }

        function showComparison() {
            console.log('📊 Showing comparison view');
            hideResults();
            hideError();
            document.getElementById('comparisonView').style.display = 'flex';
            document.getElementById('comparisonView').scrollIntoView({ behavior: 'smooth' });
        }

        function hideComparison() {
            document.getElementById('comparisonView').style.display = 'none';
        }

        function hideResults() {
            document.getElementById('resultsContainer').style.display = 'none';
        }

        function showError(message) {
            console.log('❌ Showing error:', message);
            const errorDiv = document.getElementById('errorMessage');
            errorDiv.textContent = message;
            errorDiv.style.display = 'block';
            errorDiv.scrollIntoView({ behavior: 'smooth' });
        }

        function hideError() {
            document.getElementById('errorMessage').style.display = 'none';
        }

        function showConversionPrompts() {
            // Placeholder for conversion logic
            console.log('💰 Showing conversion prompts...');
        }

        function isValidUrl(string) {
            try {
                new URL(string);
                return true;
            } catch (_) {
                return false;
            }
        }

        // FIXED FUNCTION NAME - This was the main issue!
        function startAnalysis() {
            console.log('🚀 Starting analysis...');
            analyzeNews();
        }

        function displayResults(data, tier) {
            console.log('📊 Displaying results for tier:', tier);
            const container = document.getElementById('resultsContainer');
            container.style.display = 'block';
            container.classList.add('fade-in');

            const score = Math.round(data.scoring?.overall_credibility || 75);
            const grade = getGradeFromScore(score);
            const assessment = getConversationalAssessment(score, data);

            container.innerHTML = `
                <div class="executive-summary">
                    <div class="credibility-header">
                        <div class="credibility-score">
                            <div class="score-circle" style="background: ${getScoreColor(score)}; box-shadow: 0 0 30px ${getScoreColor(score)}40;">
                                ${score}
                            </div>
                            <div>
                                <div class="assessment-text" style="color: ${getScoreColor(score)};">
                                    ${getScoreLabel(score)}
                                </div>
                                <div style="font-size: 1rem; opacity: 0.8;">Grade: ${grade}</div>
                            </div>
                        </div>
                        <div class="grade-badge" style="background: ${getScoreColor(score)}; color: white;">
                            ${tier === 'free' ? 'Free Analysis' : 'Premium Analysis'}
                        </div>
                    </div>
                    
                    <div class="conversation-bubble">
                        <h4>🤖 What I Found:</h4>
                        <p>${assessment}</p>
                        <div class="key-point">
                            <strong>Bottom Line:</strong> This content scored <strong>${score}/100</strong> on our credibility scale, which puts it in the <strong>"${getScoreLabel(score)}"</strong> category.
                        </div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 20px;">
                        <div style="background: rgba(102, 126, 234, 0.1); padding: 20px; border-radius: 15px; text-align: center;">
                            <div style="font-size: 2rem; font-weight: bold; color: ${getScoreColor(score)};">${score}</div>
                            <div style="font-size: 0.9rem; opacity: 0.8;">Credibility Score</div>
                        </div>
                        <div style="background: rgba(102, 126, 234, 0.1); padding: 20px; border-radius: 15px; text-align: center;">
                            <div style="font-size: 2rem; font-weight: bold; color: #667eea;">${grade}</div>
                            <div style="font-size: 0.9rem; opacity: 0.8;">Letter Grade</div>
                        </div>
                        <div style="background: rgba(102, 126, 234, 0.1); padding: 20px; border-radius: 15px; text-align: center;">
                            <div style="font-size: 2rem; font-weight: bold; color: #764ba2;">${data.source_verification?.sources_found || 0}</div>
                            <div style="font-size: 0.9rem; opacity: 0.8;">Sources Found</div>
                        </div>
                        <div style="background: rgba(102, 126, 234, 0.1); padding: 20px; border-radius: 15px; text-align: center;">
                            <div style="font-size: 2rem; font-weight: bold; color: #059669;">${Math.round(data.ai_analysis?.confidence_level || 85)}%</div>
                            <div style="font-size: 0.9rem; opacity: 0.8;">AI Confidence</div>
                        </div>
                    </div>
                </div>

                <div class="analysis-grid">
                    <div class="analysis-card">
                        <div class="card-header">
                            <div class="card-title">
                                <div class="card-icon">🤖</div>
                                AI Analysis
                            </div>
                        </div>
                        
                        <div class="conversation-bubble">
                            <h4>🧠 What our AI thinks:</h4>
                            <p>${getAIConversation(data.ai_analysis, score)}</p>
                            <div class="key-point">
                                I'm ${Math.round(data.ai_analysis?.confidence_level || 85)}% confident in this assessment based on the language patterns, structure, and content quality I analyzed.
                            </div>
                        </div>
                        
                        <div class="metric-item">
                            <span>Overall Assessment:</span>
                            <span style="color: ${getScoreColor(score)}; font-weight: bold;">${score}/100</span>
                        </div>
                        <div class="metric-bar">
                            <div class="metric-fill" style="width: ${score}%; background: ${getScoreColor(score)};"></div>
                        </div>
                    </div>

                    <div class="analysis-card">
                        <div class="card-header">
                            <div class="card-title">
                                <div class="card-icon">📰</div>
                                Source Verification
                            </div>
                        </div>
                        
                        <div class="conversation-bubble">
                            <h4>🔍 Source check results:</h4>
                            <p>${getSourceConversation(data.source_verification)}</p>
                            ${data.source_verification?.sources_found > 0 ? `
                                <div class="key-point">
                                    The sources I found had an average credibility rating of ${Math.round(data.source_verification.average_source_credibility || 70)}/100, which ${data.source_verification.average_source_credibility >= 70 ? 'strengthens' : 'weakens'} the overall assessment.
                                </div>
                            ` : ''}
                        </div>
                        
                        <div class="metric-item">
                            <span>Sources Found:</span>
                            <span style="font-weight: bold;">${data.source_verification?.sources_found || 0}</span>
                        </div>
                        
                        ${data.source_verification?.sources_found > 0 ? `
                            <div class="metric-item">
                                <span>Avg Source Quality:</span>
                                <span style="color: ${getScoreColor(data.source_verification.average_source_credibility || 70)}; font-weight: bold;">
                                    ${Math.round(data.source_verification.average_source_credibility || 70)}/100
                                </span>
                            </div>
                            <div class="metric-bar">
                                <div class="metric-fill" style="width: ${data.source_verification.average_source_credibility || 70}%; background: ${getScoreColor(data.source_verification.average_source_credibility || 70)};"></div>
                            </div>
                        ` : ''}
                    </div>

                    ${tier === 'trial' ? `
                        <div class="analysis-card">
                            <div class="card-header">
                                <div class="card-title">
                                    <div class="card-icon">🎯</div>
                                    Political Bias Analysis
                                </div>
                            </div>
                            
                            <div class="conversation-bubble">
                                <h4>⚖️ Bias assessment:</h4>
                                <p>${getBiasConversation(data.political_bias)}</p>
                                <div class="key-point">
                                    This kind of analysis helps you understand the perspective and potential agenda behind the content you're reading.
                                </div>
                            </div>
                            
                            <div class="bias-meter">
                                <div class="bias-indicator" style="left: ${(data.political_bias?.bias_score + 100) / 2 || 50}%;"></div>
                            </div>
                            <div class="bias-labels">
                                <span>Left</span>
                                <span>Center</span>
                                <span>Right</span>
                            </div>
                        </div>
                    ` : `
                        <div class="analysis-card">
                            <div class="premium-lock">
                                <div class="lock-icon">🔒</div>
                                <div class="lock-text">Political Bias Analysis</div>
                                <div style="opacity: 0.8;">Unlock with Premium</div>
                                <button class="unlock-btn" onclick="selectTier('trial')">Try Premium</button>
                            </div>
                        </div>
                    `}
                </div>
            `;
            
            container.scrollIntoView({ behavior: 'smooth' });
        }

        // Enhanced progress system with stages
        function updateProgressStage(stage) {
            currentStage = stage;
            document.querySelectorAll('.stage-dot').forEach((dot, index) => {
                dot.classList.remove('active', 'completed');
                if (index < stage) {
                    dot.classList.add('completed');
                } else if (index === stage) {
                    dot.classList.add('active');
                }
            });
        }

        // Helper functions for conversational assessments
        function getConversationalAssessment(score, data) {
            if (score >= 85) {
                return "Excellent news! This content demonstrates strong credibility indicators. My AI analysis found professional language, proper sourcing, and factual consistency. You can feel confident sharing this information with others.";
            } else if (score >= 70) {
                return "This looks pretty good! The content shows solid credibility with only some minor concerns. The writing appears professional and most claims seem well-supported. I'd consider it reliable, though you might want to verify key claims independently.";
            } else if (score >= 55) {
                return "I'm seeing mixed signals here. While some aspects of this content appear credible, my analysis found several concerns that affect its overall reliability. I'd recommend cross-checking the main claims with other sources before sharing.";
            } else if (score >= 40) {
                return "I'd proceed with caution on this one. This content raises multiple red flags in my credibility analysis. The sourcing may be weak, language potentially biased, or claims unsubstantiated. Definitely verify through reliable sources before believing or sharing.";
            } else {
                return "I have significant concerns about this content. My analysis suggests serious credibility issues - weak sourcing, potential misinformation, or highly biased presentation. I'd strongly recommend finding alternative, more reliable sources on this topic.";
            }
        }

        function getAIConversation(aiData, score) {
            const confidence = aiData?.confidence_level || 85;
            if (score >= 75) {
                return `I found strong credibility markers in this content with ${confidence}% confidence. The professional language, factual tone, and logical structure all point to reliable information. The writing style and content quality suggest this comes from a credible source.`;
            } else if (score >= 50) {
                return `I detected mixed credibility signals with ${confidence}% confidence. There are some good indicators present, but also areas of concern that lower the overall reliability score. The content has both strengths and weaknesses.`;
            } else {
                return `I identified multiple credibility concerns with ${confidence}% confidence. The content shows patterns I often see in unreliable or biased information sources - things like emotional language, lack of sourcing, or questionable claims.`;
            }
        }

        function getSourceConversation(sourceData) {
            const sourcesFound = sourceData?.sources_found || 0;
            if (sourcesFound >= 3) {
                return `Great news! I found ${sourcesFound} sources covering similar topics, which helps verify the information. When multiple reputable sources report on the same story, it significantly strengthens credibility. Cross-referencing like this is one of the best ways to verify news.`;
            } else if (sourcesFound >= 1) {
                return `I found ${sourcesFound} related source${sourcesFound > 1 ? 's' : ''} for comparison. While this provides some verification, having more sources would make the validation stronger. Limited source availability makes independent verification more challenging.`;
            } else {
                return "I wasn't able to find matching sources in my database. This could mean the information is very recent, from a specialized field, or potentially unverified by major news outlets. When stories aren't covered by multiple sources, that's worth noting.";
            }
        }

        function getBiasConversation(biasData) {
            const biasScore = biasData?.bias_score || 0;
            const absScore = Math.abs(biasScore);
            
            if (absScore <= 15) {
                return "Excellent neutrality! The language appears balanced and objective, with minimal political lean detected. This suggests fair, unbiased reporting that presents information without pushing a particular agenda.";
            } else if (absScore <= 35) {
                return `I detected moderate ${biasScore < 0 ? 'left-leaning' : 'right-leaning'} bias in the language and framing. While not extreme, there are subtle word choices and presentation styles that suggest a political perspective. It's still within reasonable bounds for most readers, but good to be aware of.`;
            } else {
                return `I found strong ${biasScore < 0 ? 'left-leaning' : 'right-leaning'} bias in this content. The language and framing show clear political positioning rather than neutral reporting. This doesn't necessarily make it wrong, but you should consider seeking additional perspectives from different viewpoints to get the full picture.`;
            }
        }

        function getScoreLabel(score) {
            if (score >= 85) return "HIGHLY CREDIBLE";
            if (score >= 70) return "CREDIBLE";
            if (score >= 55) return "MIXED CREDIBILITY";
            if (score >= 40) return "LOW CREDIBILITY";
            return "VERY LOW CREDIBILITY";
        }

        // Helper functions for colors and scoring
        function getScoreColor(score) {
            if (score >= 80) return '#00cc44';
            if (score >= 60) return '#88cc00';
            if (score >= 40) return '#ffaa00';
            return '#ff4444';
        }

        function getBiasColor(biasScore) {
            if (Math.abs(biasScore) <= 20) return '#cccccc';
            if (biasScore < 0) return '#4488cc';
            return '#cc8888';
        }

        function getExpertiseColor(expertise) {
            switch(expertise.toLowerCase()) {
                case 'expert': return '#00cc44';
                case 'professional': return '#88cc00';
                case 'amateur': return '#ffaa00';
                default: return '#cc8888';
            }
        }

        function getCredibilityBadgeColor(score) {
            if (score >= 80) return 'rgba(0, 204, 68, 0.3)';
            if (score >= 60) return 'rgba(136, 204, 0, 0.3)';
            if (score >= 40) return 'rgba(255, 170, 0, 0.3)';
            return 'rgba(255, 68, 68, 0.3)';
        }

        function getClaimClass(rating) {
            const ratingLower = rating.toLowerCase();
            if (ratingLower.includes('true') || ratingLower.includes('accurate')) return 'verified';
            if (ratingLower.includes('false') || ratingLower.includes('inaccurate')) return 'disputed';
            return 'mixed';
        }

        function getGradeFromScore(score) {
            if (score >= 97) return "A+";
            if (score >= 93) return "A";
            if (score >= 90) return "A-";
            if (score >= 87) return "B+";
            if (score >= 83) return "B";
            if (score >= 80) return "B-";
            if (score >= 77) return "C+";
            if (score >= 73) return "C";
            if (score >= 70) return "C-";
            if (score >= 67) return "D+";
            if (score >= 63) return "D";
            if (score >= 60) return "D-";
            return "F";
        }

        // URL content extraction (simplified for demo)
        async function extractUrlContent(url) {
            try {
                updateProgress(25, 'Extracting content from URL...', 'Simulating content extraction...');
                await new Promise(resolve => setTimeout(resolve, 800));
                
                return {
                    success: true,
                    content: `Simulated content extraction from: ${url}\n\nThis represents the main article content that would be extracted from the webpage. The analysis will proceed with this extracted content to demonstrate the URL analysis feature.`
                };
                
            } catch (error) {
                return {
                    success: false,
                    error: 'Failed to extract content from URL. Please try pasting the text directly.'
                };
            }
        }

        function selectTier(tier) {
            if (tier === 'free' && !usageTracker.canUseFree()) return;
            if (tier === 'trial' && !usageTracker.canUseTrial()) return;

            currentTier = tier;
            
            // Update button states
            document.querySelectorAll('.tier-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById(tier + 'Btn').classList.add('active');

            // Update analyze button text
            const analyzeBtn = document.getElementById('analyzeBtn');
            if (tier === 'free') {
                analyzeBtn.textContent = '🚀 ANALYZE NEWS (FREE)';
            } else {
                analyzeBtn.textContent = '⭐ TRY PREMIUM ANALYSIS';
            }
        }

        async function analyzeNews() {
            let text = '';
            let sourceUrl = '';
            
            // Get input based on current type
            if (currentInputType === 'text') {
                text = document.getElementById('newsText').value.trim();
                if (!text || text.length < 10) {
                    showError('Please enter at least 10 characters of news content to analyze.');
                    return;
                }
            } else {
                const url = document.getElementById('newsUrl').value.trim();
                if (!url || !isValidUrl(url)) {
                    showError('Please enter a valid news article URL.');
                    return;
                }
                sourceUrl = url;
                text = `Content from: ${url}\n\nThis is simulated content extraction from the provided URL for demonstration purposes.`;
            }

            // Check usage limits
            if (currentTier === 'free' && !usageTracker.canUseFree()) {
                showError('You\'ve used all your free analyses today. Try Premium or wait for tomorrow!');
                return;
            }

            if (currentTier === 'trial' && !usageTracker.canUseTrial()) {
                showError('You\'ve already used your Premium trial. Upgrade to continue!');
                return;
            }

            // Consume usage
            if (currentTier === 'free') {
                usageTracker.useFree();
            } else {
                usageTracker.useTrial();
            }

            // Reset UI
            hideError();
            showProgress();
            hideResults();
            hideComparison();
            
            try {
                // Enhanced progress with stages
                updateProgressStage(0);
                updateProgress(5, '🚀 Starting analysis...', 'Initializing AI systems');
                await new Promise(resolve => setTimeout(resolve, 600));
                
                updateProgressStage(1);
                updateProgress(25, '🤖 AI analyzing content...', 'Processing language patterns and structure');
                await new Promise(resolve => setTimeout(resolve, 800));
                
                updateProgressStage(2);
                updateProgress(45, '📰 Checking sources...', 'Cross-referencing with news databases');
                await new Promise(resolve => setTimeout(resolve, 700));
                
                if (currentTier === 'trial') {
                    updateProgressStage(3);
                    updateProgress(65, '🎯 Detecting political bias...', 'Analyzing political language and framing');
                    await new Promise(resolve => setTimeout(resolve, 600));
                    
                    updateProgress(80, '📝 Author analysis...', 'Evaluating writing style and credibility');
                    await new Promise(resolve => setTimeout(resolve, 500));
                }
                
                updateProgressStage(4);
                updateProgress(95, '📊 Finalizing scores...', 'Computing final credibility assessment');
                await new Promise(resolve => setTimeout(resolve, 400));
                
                updateProgress(100, '✅ Analysis complete!', 'Results ready');
                
                // Generate realistic mock data
                const mockData = generateMockAnalysis(text, currentTier);

                setTimeout(() => {
                    hideProgress();
                    displayResults(mockData, currentTier);
                    showConversionPrompts();
                }, 700);

            } catch (error) {
                hideProgress();
                showError('Analysis failed. Please try again.');
                console.error('Analysis error:', error);
            }
        }

        function generateMockAnalysis(text, tier) {
            const wordCount = text.split(' ').length;
            
            // Generate realistic but random scores
            const baseScore = 45 + Math.random() * 40; // 45-85 range
            const biasScore = (Math.random() - 0.5) * 80; // -40 to +40 range
            const confidence = 70 + Math.random() * 25; // 70-95 range
            
            const mockData = {
                status: 'success',
                timestamp: new Date().toISOString(),
                scoring: {
                    overall_credibility: Math.round(baseScore * 10) / 10,
                    credibility_grade: baseScore >= 80 ? 'A' : baseScore >= 70 ? 'B' : baseScore >= 60 ? 'C' : 'D',
                    author_credibility: Math.round((baseScore + Math.random() * 20 - 10)),
                    bias_score: Math.round(biasScore),
                    bias_intensity: Math.abs(Math.round(biasScore))
                },
                executive_summary: {
                    main_assessment: baseScore >= 75 ? 'HIGH CREDIBILITY' : baseScore >= 50 ? 'MODERATE CREDIBILITY' : 'LOW CREDIBILITY',
                    assessment_color: baseScore >= 75 ? 'green' : baseScore >= 50 ? 'yellow' : 'orange',
                    credibility_score: Math.round(baseScore),
                    summary_text: `${baseScore >= 75 ? 'HIGH' : baseScore >= 50 ? 'MODERATE' : 'LOW'} CREDIBILITY: This content shows ${Math.abs(biasScore) <= 20 ? 'relatively neutral' : 'biased'} language patterns. Analysis completed successfully.`,
                    key_findings: [
                        `Credibility Score: ${Math.round(baseScore)}/100`,
                        `Political Bias: ${getBiasLabel(biasScore)}`,
                        `Word Count: ${wordCount}`,
                        `Confidence: ${Math.round(confidence)}%`
                    ],
                    recommendation: getRecommendation(baseScore, biasScore)
                },
                ai_analysis: {
                    status: 'success',
                    credibility_score: Math.round(baseScore),
                    confidence_level: Math.round(confidence),
                    writing_quality: Math.round(baseScore + Math.random() * 20 - 10),
                    detailed_explanation: `Analysis of ${wordCount} words shows ${baseScore >= 70 ? 'strong' : baseScore >= 50 ? 'moderate' : 'weak'} credibility indicators.`,
                    factual_claims: generateMockClaims(text),
                    credibility_indicators: generateMockIndicators(true),
                    red_flags: baseScore < 60 ? generateMockIndicators(false) : []
                },
                political_bias: tier === 'trial' ? {
                    status: 'success',
                    bias_score: Math.round(biasScore),
                    bias_label: getBiasLabel(biasScore),
                    objectivity_score: Math.round(100 - Math.abs(biasScore) * 1.2),
                    bias_explanation: `Content shows ${Math.abs(biasScore) <= 10 ? 'minimal' : Math.abs(biasScore) <= 30 ? 'moderate' : 'significant'} political bias.`,
                    political_keywords: generateMockKeywords()
                } : { status: 'locked' },
                author_analysis: tier === 'trial' ? {
                    status: 'success',
                    writing_style_score: Math.round(baseScore + Math.random() * 20 - 10),
                    professionalism_score: Math.round(baseScore + Math.random() * 15 - 5),
                    estimated_expertise_level: baseScore >= 70 ? 'professional' : baseScore >= 50 ? 'amateur' : 'questionable',
                    style_analysis: 'Writing demonstrates appropriate structure and vocabulary for the topic.'
                } : { status: 'locked' },
                source_verification: {
                    status: 'success',
                    sources_found: Math.floor(Math.random() * 5) + 1,
                    average_source_credibility: Math.round(baseScore + Math.random() * 10),
                    articles: generateMockSources()
                },
                fact_check_results: {
                    status: 'success',
                    fact_checks_found: Math.random() > 0.7 ? Math.floor(Math.random() * 3) + 1 : 0,
                    claims: []
                }
            };
            
            return mockData;
        }

        function generateMockClaims(text) {
            const claims = [
                'Article discusses current events',
                'Content contains factual statements',
                'Text includes specific details'
            ];
            return claims.slice(0, Math.floor(Math.random() * 3) + 1);
        }

        function generateMockIndicators(positive) {
            const positiveIndicators = [
                'Professional writing style',
                'Factual language used',
                'Specific details provided',
                'Clear attribution'
            ];
            const negativeIndicators = [
                'Sensational language detected',
                'Lack of specific sources',
                'Emotional appeal present',
                'Unverified claims'
            ];
            const list = positive ? positiveIndicators : negativeIndicators;
            return list.slice(0, Math.floor(Math.random() * 3) + 1);
        }

        function generateMockKeywords() {
            const keywords = ['policy', 'government', 'officials', 'administration', 'political'];
            return keywords.slice(0, Math.floor(Math.random() * 3) + 1);
        }

        function generateMockSources() {
            const sources = [
                { title: 'Related news coverage found', source_name: 'Associated Press', credibility_score: 90, bias_rating: 'center' },
                { title: 'Similar story verification', source_name: 'Reuters', credibility_score: 95, bias_rating: 'center' },
                { title: 'Cross-reference article', source_name: 'BBC News', credibility_score: 88, bias_rating: 'center-left' }
            ];
            return sources.slice(0, Math.floor(Math.random() * 3) + 1);
        }

        function getBiasLabel(biasScore) {
            if (biasScore <= -30) return 'Left';
            else if (biasScore <= -10) return 'Center-Left';
            else if (biasScore <= 10) return 'Center';
            else if (biasScore <= 30) return 'Center-Right';
            else return 'Right';
        }

        function getRecommendation(credibilityScore, biasScore) {
            if (credibilityScore >= 80 && Math.abs(biasScore) <= 20) {
                return "This content appears highly credible and relatively unbiased. Safe to share.";
            } else if (credibilityScore >= 60) {
                return "This content has moderate credibility. Consider cross-referencing with other sources.";
            } else if (Math.abs(biasScore) >= 30) {
                return "This content shows significant bias. Seek alternative perspectives before forming opinions.";
            } else {
                return "This content has credibility concerns. Verify claims through authoritative sources before sharing.";
            }
        }

        function showUpgradeOptions() {
            alert('🚀 Upgrade to Premium!\n\n✓ Unlimited daily analysis\n✓ Political bias detection\n✓ Author credibility profiling\n✓ Cross-platform verification\n✓ Professional reporting\n✓ Priority support\n\nOnly $9.99/month\n\n[Integration with payment system needed]');
        }

        // Enhanced progress functions
        function updateProgress(percentage, text, detail = '') {
            document.getElementById('progressFill').style.width = percentage + '%';
            document.getElementById('progressText').textContent = text;
            document.getElementById('progressDetails').textContent = detail;
        }

        function showProgress() {
            document.getElementById('progressContainer').style.display = 'block';
            document.getElementById('progressTimer').style.display = 'none';
            updateProgress(0, 'Initializing Analysis...', 'Preparing AI models...');
            updateProgressStage(0);
        }

        function hideProgress() {
            document.getElementById('progressContainer').style.display = 'none';
        }

        // Initialize the interface
        document.addEventListener('DOMContentLoaded', function() {
            console.log('🚀 Facts & Fakes system loading...');
            selectTier('free');
            console.log('✅ Facts & Fakes freemium system loaded successfully');
        });

        // Keyboard shortcut
        document.addEventListener('keydown', function(e) {
            if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
                startAnalysis();
            }
        });
    </script>
</body>
</html>
