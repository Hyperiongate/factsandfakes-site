<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>News Misinformation Detector - FactsAndFakes.ai</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            color: white;
        }

        .header h1 {
            font-size: 3rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .nav-bar {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 40px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .nav-links {
            display: flex;
            justify-content: center;
            gap: 30px;
            flex-wrap: wrap;
        }

        .nav-links a {
            color: white;
            text-decoration: none;
            padding: 10px 20px;
            border-radius: 10px;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .nav-links a:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .nav-links a.active {
            background: rgba(255, 255, 255, 0.3);
            font-weight: 600;
        }

        .tool-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .tool-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .tool-header h2 {
            font-size: 2.5rem;
            color: #4a5568;
            margin-bottom: 10px;
        }

        .tool-header p {
            font-size: 1.1rem;
            color: #718096;
        }

        /* Tier Selector */
        .tier-selector {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .tier-btn {
            background: #374151;
            color: #ffffff;
            border: 2px solid #374151;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            border-radius: 12px;
            padding: 14px 28px;
            font-size: 1rem;
            position: relative;
        }

        .tier-btn:hover {
            background: #4b5563;
            border-color: #4b5563;
            transform: translateY(-1px);
        }

        .tier-btn.active {
            background: #667eea;
            border-color: #667eea;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }

        .tier-btn:disabled {
            opacity: 0.4;
            cursor: not-allowed;
            background: #6b7280;
            color: #ffffff;
            border-color: #6b7280;
        }

        .tier-badge {
            position: absolute;
            top: -8px;
            right: -8px;
            background: #ff4444;
            color: white;
            font-size: 0.7rem;
            padding: 2px 6px;
            border-radius: 10px;
            font-weight: bold;
        }

        /* PROMINENT FIXED PROGRESS BAR */
        .progress-container {
            display: none;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 40px 30px;
            border-radius: 0 0 25px 25px;
            margin: 0;
            box-shadow: 
                0 25px 60px rgba(102, 126, 234, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            border: 3px solid rgba(255, 255, 255, 0.1);
            border-top: none;
            position: fixed;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 90%;
            max-width: 800px;
            z-index: 1000;
            color: white;
            overflow: hidden;
        }

        .progress-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            animation: progress-shimmer 3s infinite;
        }

        @keyframes progress-shimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .progress-text {
            text-align: center;
            font-weight: 700;
            color: white;
            margin-bottom: 20px;
            font-size: 1.3rem;
            text-shadow: 
                0 2px 4px rgba(0, 0, 0, 0.3),
                0 0 20px rgba(255, 255, 255, 0.3);
            position: relative;
            z-index: 2;
        }

        .progress-bar {
            width: 100%;
            height: 24px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 15px;
            overflow: hidden;
            margin-bottom: 30px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            position: relative;
            box-shadow: 
                inset 0 2px 4px rgba(0, 0, 0, 0.3),
                0 0 20px rgba(255, 255, 255, 0.1);
            z-index: 2;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, 
                #00ff88 0%, 
                #00cc44 25%, 
                #ffaa00 50%, 
                #ff6600 75%, 
                #ff0066 100%);
            border-radius: 15px;
            transition: width 1.2s cubic-bezier(0.4, 0, 0.2, 1);
            width: 0%;
            position: relative;
            box-shadow: 
                0 0 25px rgba(0, 255, 136, 0.6),
                inset 0 2px 0 rgba(255, 255, 255, 0.3);
            overflow: hidden;
        }

        .progress-fill::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255,255,255,0.5), 
                transparent);
            animation: progress-wave 1.8s infinite;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 2px;
            left: 2px;
            right: 2px;
            height: 8px;
            background: linear-gradient(90deg, 
                rgba(255,255,255,0.9), 
                rgba(255,255,255,0.3));
            border-radius: 10px;
        }

        @keyframes progress-wave {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .progress-details {
            text-align: center;
            font-size: 1.2rem;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 20px;
            font-weight: 500;
            position: relative;
            z-index: 2;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
        }

        .loading-spinner {
            width: 80px;
            height: 80px;
            border: 8px solid rgba(255, 255, 255, 0.2);
            border-left: 8px solid #00ff88;
            border-top: 8px solid #ffaa00;
            border-radius: 50%;
            animation: enhanced-spin 1.5s linear infinite;
            margin: 30px auto;
            box-shadow: 
                0 0 40px rgba(0, 255, 136, 0.4),
                inset 0 0 20px rgba(255, 255, 255, 0.1);
            position: relative;
            z-index: 2;
        }

        .loading-spinner::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 40px;
            height: 40px;
            border: 4px solid transparent;
            border-top: 4px solid #ffffff;
            border-radius: 50%;
            transform: translate(-50%, -50%);
            animation: enhanced-spin 0.8s linear infinite reverse;
        }

        @keyframes enhanced-spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Enhanced Input Section */
        .input-section {
            margin-bottom: 30px;
        }

        .input-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 2px solid #e2e8f0;
        }

        .input-tab {
            padding: 12px 24px;
            border: none;
            background: #f8fafc;
            color: #6b7280;
            font-weight: 600;
            cursor: pointer;
            border-radius: 12px 12px 0 0;
            transition: all 0.3s ease;
            font-size: 0.95rem;
            border-bottom: 3px solid transparent;
        }

        .input-tab:hover {
            background: #f1f5f9;
            color: #374151;
        }

        .input-tab.active {
            background: white;
            color: #667eea;
            border-bottom-color: #667eea;
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
        }

        .input-content {
            display: none;
        }

        .input-content.active {
            display: block;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #4a5568;
        }

        .input-group input, .input-group textarea {
            width: 100%;
            padding: 15px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s ease;
            background: white;
        }

        .input-group input:focus, .input-group textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .input-group textarea {
            min-height: 120px;
            resize: vertical;
        }

        /* Sample Articles */
        .sample-articles {
            margin-bottom: 20px;
        }

        .sample-btn {
            background: rgba(102, 126, 234, 0.1);
            border: 2px solid #667eea;
            color: #667eea;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            margin: 5px;
            transition: all 0.3s ease;
        }

        .sample-btn:hover {
            background: #667eea;
            color: white;
        }

        .char-counter {
            text-align: right;
            font-size: 0.9rem;
            color: #6b7280;
            margin-top: 5px;
        }

        .char-counter.warning {
            color: #ff6600;
        }

        .char-counter.error {
            color: #ff4444;
        }

        .analyze-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 10px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            margin-bottom: 30px;
        }

        .analyze-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
        }

        .analyze-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        /* Results Section */
        .results {
            display: none;
            margin-top: 30px;
        }

        .executive-summary {
            background: #f8fafc;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            border-left: 5px solid #667eea;
        }

        .credibility-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .credibility-score {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .score-circle {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: 800;
            color: white;
        }

        .assessment-text {
            font-size: 1.3rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .grade-badge {
            background: #667eea;
            color: white;
            padding: 8px 16px;
            border-radius: 25px;
            font-weight: 700;
            font-size: 1.1rem;
        }

        /* Enhanced Result Cards */
        .analysis-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
            margin-top: 30px;
        }

        .analysis-card {
            background: white;
            border-radius: 20px;
            padding: 25px;
            border: 1px solid #e2e8f0;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .analysis-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        }

        .card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #e2e8f0;
        }

        .card-title {
            font-size: 1.3rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
            color: #4a5568;
        }

        .card-icon {
            width: 24px;
            height: 24px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            color: white;
        }

        /* Expandable Sections */
        .expandable-sections {
            margin-top: 30px;
        }

        .expandable-section {
            background: white;
            border-radius: 15px;
            margin: 20px 0;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            border: 1px solid #e2e8f0;
            overflow: hidden;
        }

        .section-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px 25px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: 700;
            font-size: 1.2rem;
            transition: all 0.3s ease;
        }

        .section-header:hover {
            background: linear-gradient(135deg, #5a6fd8 0%, #6b4190 100%);
        }

        .section-header .toggle-icon {
            font-size: 1.5rem;
            transition: transform 0.3s ease;
        }

        .section-header.expanded .toggle-icon {
            transform: rotate(180deg);
        }

        .section-content {
            padding: 0;
            max-height: 0;
            overflow: hidden;
            transition: all 0.4s ease;
        }

        .section-content.expanded {
            padding: 25px;
            max-height: 1000px;
        }

        .detail-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .detail-box {
            background: rgba(102, 126, 234, 0.05);
            padding: 20px;
            border-radius: 15px;
            border-left: 4px solid #667eea;
        }

        .detail-box h5 {
            color: #667eea;
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .detail-box p {
            line-height: 1.6;
            color: #374151;
            margin-bottom: 10px;
        }

        .confidence-badge {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 0.9rem;
            font-weight: 600;
            margin: 3px;
        }

        .confidence-high { background: rgba(0, 204, 68, 0.2); color: #00cc44; }
        .confidence-medium { background: rgba(255, 170, 0, 0.2); color: #ffaa00; }
        .confidence-low { background: rgba(255, 68, 68, 0.2); color: #ff4444; }

        .metric-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 15px 0;
            color: #374151;
        }

        .metric-bar {
            background: #e2e8f0;
            height: 8px;
            border-radius: 10px;
            margin: 10px 0;
            overflow: hidden;
        }

        .metric-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            border-radius: 10px;
            transition: width 0.8s ease;
        }

        .warning-card {
            background: #fed7d7;
            border-left-color: #f56565;
            color: #742a2a;
        }

        .warning-card .card-icon {
            background: #f56565;
        }

        .success-card {
            background: #c6f6d5;
            border-left-color: #48bb78;
            color: #22543d;
        }

        .success-card .card-icon {
            background: #48bb78;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }

            .tool-header h2 {
                font-size: 2rem;
            }

            .nav-links {
                gap: 15px;
            }

            .nav-links a {
                padding: 8px 15px;
                font-size: 0.9rem;
            }

            .tool-container {
                padding: 25px;
            }

            .analysis-grid {
                grid-template-columns: 1fr;
            }

            .credibility-header {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-shield-alt"></i> FactsAndFakes.ai</h1>
            <p>Professional AI-Powered Content Verification Platform</p>
        </div>

        <nav class="nav-bar">
            <div class="nav-links">
                <a href="index.html"><i class="fas fa-home"></i> Home</a>
                <a href="news.html" class="active"><i class="fas fa-newspaper"></i> News Verification</a>
                <a href="unifiedcontent.html"><i class="fas fa-search"></i> Content Authenticity</a>
                <a href="imageanalysis.html"><i class="fas fa-image"></i> AI Image Analysis</a>
                <a href="mission.html"><i class="fas fa-bullseye"></i> Our Mission</a>
                <a href="pricing.html"><i class="fas fa-tags"></i> Pricing</a>
                <a href="contact.html"><i class="fas fa-envelope"></i> Contact</a>
            </div>
        </nav>

        <div class="tool-container">
            <div class="tool-header">
                <h2><i class="fas fa-newspaper"></i> News Misinformation Detector</h2>
                <p>Comprehensive AI-powered fact-checking and credibility analysis</p>
            </div>

            <div class="tier-selector">
                <button class="tier-btn active" id="freeBtn" onclick="selectTier('free')">
                    üÜì Free Analysis
                    <span class="tier-badge" id="freeBadge">3 left</span>
                </button>
                <button class="tier-btn" id="trialBtn" onclick="selectTier('trial')">
                    ‚≠ê Try Premium
                    <span class="tier-badge" id="trialBadge">1 left</span>
                </button>
            </div>

            <div class="input-section">
                <div class="input-tabs">
                    <button class="input-tab active" onclick="switchInputType('text')">üìù Paste Text</button>
                    <button class="input-tab" onclick="switchInputType('url')">üîó Analyze URL</button>
                </div>
                
                <div class="sample-articles">
                    <label style="font-size: 1rem; margin-bottom: 10px; font-weight: 600; color: #4a5568;">üìö Try Sample Articles:</label>
                    <div>
                        <button class="sample-btn" onclick="loadSample('reliable')">üì∞ Reliable News</button>
                        <button class="sample-btn" onclick="loadSample('biased')">‚öñÔ∏è Biased Content</button>
                        <button class="sample-btn" onclick="loadSample('fake')">‚ùå Misinformation</button>
                        <button class="sample-btn" onclick="loadSample('mixed')">ü§î Mixed Signals</button>
                    </div>
                </div>
                
                <div class="input-content active" id="textInput">
                    <div class="input-group">
                        <label for="news-text"><i class="fas fa-file-text"></i> News Content or Claim</label>
                        <textarea id="news-text" placeholder="Paste the news article content or specific claim you want to verify..." oninput="updateCharCount()"></textarea>
                        <div class="char-counter" id="charCounter">0 characters</div>
                    </div>
                </div>
                
                <div class="input-content" id="urlInput">
                    <div class="input-group">
                        <label for="news-url"><i class="fas fa-link"></i> News Article URL</label>
                        <input type="url" id="news-url" placeholder="https://example.com/news-article">
                        <small style="color: #6b7280; margin-top: 5px; display: block;">
                            Enter a news article URL to automatically extract and analyze content
                        </small>
                    </div>
                </div>

                <button class="analyze-btn" onclick="analyzeNews()">
                    <i class="fas fa-search"></i> Verify News Credibility
                </button>
            </div>

            <div class="progress-container" id="progressContainer">
                <div class="progress-text" id="progressText">Initializing Analysis...</div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <div class="progress-details" id="progressDetails">Starting comprehensive verification...</div>
                <div class="loading-spinner"></div>
            </div>

            <div class="results" id="results">
                <!-- Enhanced results will be populated here -->
            </div>
        </div>
    </div>

    <script>
        let currentInputType = 'text';
        let currentTier = 'free';

        // Tier selection
        function selectTier(tier) {
            currentTier = tier;
            
            // Update button states
            document.querySelectorAll('.tier-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById(tier + 'Btn').classList.add('active');

            // Update analyze button text
            const analyzeBtn = document.querySelector('.analyze-btn');
            if (tier === 'free') {
                analyzeBtn.innerHTML = '<i class="fas fa-search"></i> Verify News Credibility (FREE)';
            } else {
                analyzeBtn.innerHTML = '<i class="fas fa-search"></i> Premium Analysis (TRIAL)';
            }
        }

        // Input type switching
        function switchInputType(type) {
            currentInputType = type;
            
            // Update tabs
            document.querySelectorAll('.input-tab').forEach((tab, index) => {
                tab.classList.remove('active');
                if ((type === 'text' && index === 0) || (type === 'url' && index === 1)) {
                    tab.classList.add('active');
                }
            });
            
            // Update content
            document.querySelectorAll('.input-content').forEach(content => {
                content.classList.remove('active');
            });
            
            const targetContent = document.getElementById(type + 'Input');
            if (targetContent) {
                targetContent.classList.add('active');
            }
        }

        // Sample article loading
        function loadSample(type) {
            const samples = {
                reliable: "WASHINGTON (AP) ‚Äî The Federal Reserve raised its benchmark interest rate by 0.25 percentage points Wednesday, bringing it to a 22-year high of 5.25%-5.5% as the central bank continues its fight against inflation. The decision was unanimous among voting members of the Federal Open Market Committee. Fed Chair Jerome Powell said in a news conference that the committee will assess incoming data to determine future policy moves. 'We're prepared to do more if appropriate,' Powell said, noting that inflation remains above the Fed's 2% target. Consumer prices rose 3.2% in July compared to a year earlier, according to the Labor Department.",
                
                biased: "BREAKING: Biden's Federal Reserve ATTACKS American Families Again! The radical left Fed just SLAMMED working families with another devastating rate hike, making it even harder for patriotic Americans to afford homes. This is just another example of the Biden administration's WAR on middle-class values. While coastal elites get richer, hardworking Americans suffer under these socialist economic policies. The Fed's reckless decisions are destroying our economy and punishing families who just want to live free.",
                
                fake: "EXCLUSIVE: Secret Fed Documents Reveal Plot to Crash Economy Before 2024 Election! Leaked internal memos show Federal Reserve officials deliberately planning to destroy the housing market to help Democrats. Anonymous source inside the Fed confirms that rate hikes are specifically timed to benefit certain Wall Street firms who donated to Biden's campaign. 'They don't care about regular Americans,' the whistleblower revealed. The mainstream media refuses to report this story because they're complicit in the conspiracy.",
                
                mixed: "Fed Raises Rates to 22-Year High Amid Economic Uncertainty. The Federal Reserve increased rates by 0.25% yesterday, a move that many economists expected but some critics argue goes too far. While the Fed claims this will help control inflation, some analysts warn it could trigger a recession. Chairman Powell's comments seemed confident, though markets reacted negatively. The rate hike will definitely impact mortgage rates, though experts disagree on how much."
            };
            
            document.getElementById('news-text').value = samples[type];
            updateCharCount();
            
            if (currentInputType !== 'text') {
                switchInputType('text');
            }
        }

        // Character counter
        function updateCharCount() {
            const textarea = document.getElementById('news-text');
            const counter = document.getElementById('charCounter');
            const length = textarea.value.length;
            
            counter.textContent = `${length.toLocaleString()} characters`;
            
            if (length > 5000) {
                counter.className = 'char-counter error';
                counter.textContent += ' (too long - may affect accuracy)';
            } else if (length > 3000) {
                counter.className = 'char-counter warning';
                counter.textContent += ' (optimal range: 500-3000)';
            } else if (length > 100) {
                counter.className = 'char-counter';
                counter.textContent += ' (good length)';
            } else {
                counter.className = 'char-counter';
            }
        }

        // Progress system
        function updateProgress(percentage, text, detail = '') {
            document.getElementById('progressFill').style.width = percentage + '%';
            document.getElementById('progressText').textContent = text;
            document.getElementById('progressDetails').textContent = detail;
        }

        function showProgress() {
            document.getElementById('progressContainer').style.display = 'block';
            updateProgress(0, 'Initializing Analysis...', 'Preparing verification systems...');
        }

        function hideProgress() {
            document.getElementById('progressContainer').style.display = 'none';
        }

        // Enhanced analysis function with your backend
        async function analyzeNews() {
            const newsUrl = document.getElementById('news-url').value.trim();
            const newsText = document.getElementById('news-text').value.trim();
            
            if (!newsText && !newsUrl) {
                alert('Please provide either a news URL or news content to analyze.');
                return;
            }

            // Show PROMINENT progress bar
            showProgress();
            document.getElementById('results').style.display = 'none';

            try {
                // Progressive updates with visible progress
                updateProgress(5, 'üöÄ Starting Analysis...', 'Initializing AI systems');
                await new Promise(resolve => setTimeout(resolve, 800));
                
                updateProgress(25, 'ü§ñ AI analyzing content...', 'Processing language patterns and structure');
                await new Promise(resolve => setTimeout(resolve, 1000));
                
                updateProgress(45, 'üì∞ Checking sources...', 'Cross-referencing with news databases');
                await new Promise(resolve => setTimeout(resolve, 900));
                
                if (currentTier === 'trial') {
                    updateProgress(65, 'üéØ Premium bias analysis...', 'Analyzing political language and framing');
                    await new Promise(resolve => setTimeout(resolve, 800));
                    
                    updateProgress(80, 'üìù Author verification...', 'Evaluating writing style and credibility');
                    await new Promise(resolve => setTimeout(resolve, 700));
                }
                
                updateProgress(95, 'üìä Finalizing scores...', 'Computing final credibility assessment');
                await new Promise(resolve => setTimeout(resolve, 600));

                // Call your actual backend
                const response = await fetch('https://ai-detector-backend-g4mj.onrender.com/analyze_news', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        url: newsUrl || null,
                        text: newsText || null
                    })
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const data = await response.json();
                
                updateProgress(100, '‚úÖ Analysis Complete!', 'Results ready');
                
                setTimeout(() => {
                    hideProgress();
                    displayEnhancedResults(data);
                }, 700);

            } catch (error) {
                console.error('Error:', error);
                hideProgress();
                
                document.getElementById('results').innerHTML = `
                    <div class="analysis-card warning-card">
                        <div class="card-header">
                            <div class="card-title">
                                <div class="card-icon"><i class="fas fa-exclamation-triangle"></i></div>
                                Analysis Error
                            </div>
                        </div>
                        <p>Unable to analyze the news content. Please check your internet connection and try again.</p>
                        <p style="margin-top: 10px; font-size: 0.9rem; opacity: 0.8;">Error details: ${error.message}</p>
                    </div>
                `;
                document.getElementById('results').style.display = 'block';
            }
        }

        // Enhanced results display with expandable sections
        function displayEnhancedResults(data) {
            const results = document.getElementById('results');
            results.style.display = 'block';

            // Calculate key metrics
            const credibilityScore = data.credibility_score ? Math.round(data.credibility_score * 100) : 0;
            const aiProbability = data.ai_detection ? Math.round(data.ai_detection.ai_probability * 100) : 0;
            const factCheckCount = data.fact_checks ? data.fact_checks.length : 0;
            const confidenceLevel = data.ai_detection ? Math.round(data.ai_detection.confidence * 100) : 0;

            const scoreColor = getScoreColor(credibilityScore);
            const grade = getGradeFromScore(credibilityScore);
            const assessment = getAssessment(credibilityScore);

            results.innerHTML = `
                <!-- Executive Summary -->
                <div class="executive-summary">
                    <div class="credibility-header">
                        <div class="credibility-score">
                            <div class="score-circle" style="background: ${scoreColor};">
                                ${credibilityScore}
                            </div>
                            <div>
                                <div class="assessment-text" style="color: ${scoreColor};">
                                    ${assessment}
                                </div>
                                <div style="font-size: 1rem; opacity: 0.8;">Grade: ${grade}</div>
                            </div>
                        </div>
                        <div class="grade-badge">
                            Analysis Complete
                            <span class="confidence-badge ${getConfidenceClass(confidenceLevel)}" style="margin-left: 10px;">
                                üéØ ${confidenceLevel}% Confidence
                            </span>
                        </div>
                    </div>
                    
                    <div style="background: rgba(102, 126, 234, 0.1); padding: 20px; border-radius: 15px; margin: 20px 0;">
                        <h4 style="color: #667eea; margin-bottom: 15px;">üìä Quick Summary</h4>
                        <p style="color: #374151; font-size: 1.1rem; line-height: 1.6;">
                            ${data.assessment || 'Analysis completed with comprehensive verification across multiple sources and AI detection systems.'}
                        </p>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-top: 20px;">
                        <div style="background: rgba(102, 126, 234, 0.1); padding: 20px; border-radius: 15px; text-align: center;">
                            <div style="font-size: 2rem; font-weight: bold; color: ${scoreColor};">${credibilityScore}</div>
                            <div style="font-size: 0.9rem; opacity: 0.8;">Credibility Score</div>
                        </div>
                        <div style="background: rgba(102, 126, 234, 0.1); padding: 20px; border-radius: 15px; text-align: center;">
                            <div style="font-size: 2rem; font-weight: bold; color: #667eea;">${grade}</div>
                            <div style="font-size: 0.9rem; opacity: 0.8;">Letter Grade</div>
                        </div>
                        <div style="background: rgba(102, 126, 234, 0.1); padding: 20px; border-radius: 15px; text-align: center;">
                            <div style="font-size: 2rem; font-weight: bold; color: #764ba2;">${factCheckCount}</div>
                            <div style="font-size: 0.9rem; opacity: 0.8;">Fact Checks</div>
                        </div>
                        <div style="background: rgba(102, 126, 234, 0.1); padding: 20px; border-radius: 15px; text-align: center;">
                            <div style="font-size: 2rem; font-weight: bold; color: #059669;">${confidenceLevel}%</div>
                            <div style="font-size: 0.9rem; opacity: 0.8;">AI Confidence</div>
                        </div>
                    </div>
                </div>

                <!-- Analysis Cards -->
                <div class="analysis-grid">
                    ${generateCredibilityCard(data, credibilityScore, scoreColor)}
                    ${generateAIDetectionCard(data, aiProbability)}
                    ${generateFactCheckCard(data, factCheckCount)}
                    ${generateNewsAnalysisCard(data)}
                </div>

                <!-- Expandable Detailed Sections -->
                <div class="expandable-sections">
                    ${generateExpandableSection('methodology', 'üî¨ Analysis Methodology', generateMethodologyContent(data))}
                    ${generateExpandableSection('sources', 'üì∞ Source Verification Details', generateSourceContent(data))}
                    ${generateExpandableSection('language', 'ü§ñ Language Analysis', generateLanguageContent(data))}
                    ${generateExpandableSection('recommendations', 'üí° Recommendations', generateRecommendationsContent(data, credibilityScore))}
                </div>
            `;
        }

        // Helper functions for generating card content
        function generateCredibilityCard(data, score, color) {
            const cardClass = score >= 70 ? 'success-card' : score >= 40 ? 'analysis-card' : 'warning-card';
            const icon = score >= 70 ? 'check-circle' : score >= 40 ? 'exclamation-circle' : 'times-circle';
            
            return `
                <div class="analysis-card ${cardClass}">
                    <div class="card-header">
                        <div class="card-title">
                            <div class="card-icon"><i class="fas fa-${icon}"></i></div>
                            Credibility Assessment
                        </div>
                    </div>
                    <div class="metric-item">
                        <span>Overall Score:</span>
                        <span style="color: ${color}; font-weight: bold;">${score}/100</span>
                    </div>
                    <div class="metric-bar">
                        <div class="metric-fill" style="width: ${score}%; background: ${color};"></div>
                    </div>
                    <p style="margin-top: 15px;"><strong>Assessment:</strong> ${data.assessment || 'Analysis completed'}</p>
                </div>
            `;
        }

        function generateAIDetectionCard(data, aiProbability) {
            if (!data.ai_detection) return '';
            
            const confidence = Math.round(data.ai_detection.confidence * 100);
            
            return `
                <div class="analysis-card">
                    <div class="card-header">
                        <div class="card-title">
                            <div class="card-icon"><i class="fas fa-robot"></i></div>
                            AI Content Detection
                        </div>
                    </div>
                    <div class="metric-item">
                        <span>AI Probability:</span>
                        <span style="color: #667eea; font-weight: bold;">${aiProbability}%</span>
                    </div>
                    <div class="metric-bar">
                        <div class="metric-fill" style="width: ${aiProbability}%; background: #667eea;"></div>
                    </div>
                    <p style="margin-top: 15px;"><strong>Classification:</strong> ${data.ai_detection.classification}</p>
                    <p><strong>Confidence:</strong> ${confidence}%</p>
                </div>
            `;
        }

        function generateFactCheckCard(data, factCheckCount) {
            if (!data.fact_checks || data.fact_checks.length === 0) {
                return `
                    <div class="analysis-card">
                        <div class="card-header">
                            <div class="card-title">
                                <div class="card-icon"><i class="fas fa-search"></i></div>
                                Fact Check Results
                            </div>
                        </div>
                        <p>No specific fact-checks found for this content in our database.</p>
                    </div>
                `;
            }
            
            return `
                <div class="analysis-card">
                    <div class="card-header">
                        <div class="card-title">
                            <div class="card-icon"><i class="fas fa-fact-check"></i></div>
                            Fact Check Results
                        </div>
                    </div>
                    <div class="metric-item">
                        <span>Sources Found:</span>
                        <span style="font-weight: bold;">${factCheckCount}</span>
                    </div>
                    <div style="margin-top: 15px;">
                        ${data.fact_checks.slice(0, 2).map(factCheck => `
                            <div style="background: #f8fafc; padding: 15px; border-radius: 10px; margin-bottom: 10px;">
                                <h5>${factCheck.title}</h5>
                                <p><strong>Rating:</strong> ${factCheck.rating}</p>
                                <p><strong>Source:</strong> ${factCheck.publisher}</p>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        function generateNewsAnalysisCard(data) {
            if (!data.news_analysis) return '';
            
            return `
                <div class="analysis-card">
                    <div class="card-header">
                        <div class="card-title">
                            <div class="card-icon"><i class="fas fa-chart-line"></i></div>
                            News Analysis
                        </div>
                    </div>
                    <p><strong>Source Quality:</strong> ${data.news_analysis.source_quality || 'Not available'}</p>
                    <p><strong>Bias Assessment:</strong> ${data.news_analysis.bias_assessment || 'Not available'}</p>
                    <p><strong>Content Type:</strong> ${data.news_analysis.content_type || 'Not available'}</p>
                </div>
            `;
        }

        // Expandable sections
        function generateExpandableSection(id, title, content) {
            return `
                <div class="expandable-section">
                    <div class="section-header" onclick="toggleSection('${id}')">
                        <span>${title}</span>
                        <span class="toggle-icon">‚ñº</span>
                    </div>
                    <div class="section-content" id="${id}-content">
                        ${content}
                    </div>
                </div>
            `;
        }

        function generateMethodologyContent(data) {
            return `
                <div class="detail-grid">
                    <div class="detail-box">
                        <h5>ü§ñ AI Analysis Process</h5>
                        <p>Our AI systems analyze language patterns, structure, and content consistency using advanced natural language processing models.</p>
                    </div>
                    <div class="detail-box">
                        <h5>üìä Credibility Scoring</h5>
                        <p>Multiple factors including source reputation, fact-checking results, and linguistic analysis contribute to the overall credibility score.</p>
                    </div>
                    <div class="detail-box">
                        <h5>üîç Fact Verification</h5>
                        <p>Cross-referencing with Google Fact Check Tools API and multiple authoritative fact-checking databases.</p>
                    </div>
                    <div class="detail-box">
                        <h5>üì∞ Source Analysis</h5>
                        <p>Evaluation of publication quality, editorial standards, and historical accuracy based on news industry standards.</p>
                    </div>
                </div>
            `;
        }

        function generateSourceContent(data) {
            const sourcesFound = data.source_verification?.sources_found || 0;
            return `
                <div class="detail-box">
                    <h5>üìà Source Verification Results</h5>
                    <p>Found ${sourcesFound} related sources for cross-verification.</p>
                    ${sourcesFound > 0 ? `
                        <p><strong>Average Source Quality:</strong> ${Math.round(data.source_verification.average_source_credibility || 70)}/100</p>
                    ` : ''}
                </div>
                <div style="margin-top: 20px;">
                    <h5>üîç Verification Process</h5>
                    <p>Our system checked this content against multiple news databases and fact-checking sources to verify claims and assess overall reliability.</p>
                </div>
            `;
        }

        function generateLanguageContent(data) {
            const aiData = data.ai_detection;
            if (!aiData) return '<p>AI detection analysis not available.</p>';
            
            return `
                <div class="detail-box">
                    <h5>üéØ Classification Results</h5>
                    <p><strong>Classification:</strong> ${aiData.classification}</p>
                    <p><strong>Confidence Level:</strong> ${Math.round(aiData.confidence * 100)}%</p>
                </div>
                <div style="margin-top: 20px;">
                    <h5>üî¨ Analysis Details</h5>
                    <p>Our AI detection models analyze writing patterns, vocabulary usage, sentence structure, and other linguistic markers to determine the likelihood of AI generation.</p>
                </div>
            `;
        }

        function generateRecommendationsContent(data, score) {
            let recommendations = '';
            
            if (score >= 80) {
                recommendations = `
                    <div class="detail-box">
                        <h5>‚úÖ High Credibility Content</h5>
                        <p>This content demonstrates strong credibility indicators. You can feel confident in sharing this information.</p>
                    </div>
                `;
            } else if (score >= 60) {
                recommendations = `
                    <div class="detail-box">
                        <h5>‚ö†Ô∏è Moderate Credibility</h5>
                        <p>While this content shows some credibility, consider verifying key claims through additional sources before sharing.</p>
                    </div>
                `;
            } else {
                recommendations = `
                    <div class="detail-box">
                        <h5>üö® Low Credibility Warning</h5>
                        <p>This content raises credibility concerns. We recommend finding alternative, more reliable sources on this topic.</p>
                    </div>
                `;
            }
            
            return recommendations + `
                <div style="margin-top: 20px;">
                    <h5>üí° General Tips</h5>
                    <ul style="margin-left: 20px; line-height: 1.6;">
                        <li>Always verify important claims through multiple independent sources</li>
                        <li>Check the publication date and author credentials</li>
                        <li>Be aware of emotional language that might indicate bias</li>
                        <li>Consider the source's track record and reputation</li>
                    </ul>
                </div>
            `;
        }

        function toggleSection(sectionId) {
            const header = document.querySelector(`[onclick="toggleSection('${sectionId}')"]`);
            const content = document.getElementById(`${sectionId}-content`);
            
            if (!header || !content) return;
            
            const isExpanded = content.classList.contains('expanded');
            
            if (isExpanded) {
                content.classList.remove('expanded');
                header.classList.remove('expanded');
            } else {
                content.classList.add('expanded');
                header.classList.add('expanded');
            }
        }

        // Helper functions
        function getScoreColor(score) {
            if (score >= 80) return '#00cc44';
            if (score >= 60) return '#88cc00';
            if (score >= 40) return '#ffaa00';
            return '#ff4444';
        }

        function getGradeFromScore(score) {
            if (score >= 90) return "A";
            if (score >= 80) return "B";
            if (score >= 70) return "C";
            if (score >= 60) return "D";
            return "F";
        }

        function getAssessment(score) {
            if (score >= 85) return "HIGHLY CREDIBLE";
            if (score >= 70) return "CREDIBLE";
            if (score >= 55) return "MIXED CREDIBILITY";
            if (score >= 40) return "LOW CREDIBILITY";
            return "VERY LOW CREDIBILITY";
        }

        function getConfidenceClass(score) {
            if (score >= 80) return 'confidence-high';
            if (score >= 60) return 'confidence-medium';
            return 'confidence-low';
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            selectTier('free');
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
                analyzeNews();
            }
        });

        document.getElementById('news-text').addEventListener('keydown', function(event) {
            if (event.ctrlKey && event.key === 'Enter') {
                analyzeNews();
            }
        });

        document.getElementById('news-url').addEventListener('keydown', function(event) {
            if (event.key === 'Enter') {
                analyzeNews();
            }
        });

        document.getElementById('news-text').addEventListener('keydown', function(event) {
            if (event.ctrlKey && event.key === 'Enter') {
                analyzeNews();
            }
        });

        document.getElementById('news-url').addEventListener('keydown', function(event) {
            if (event.key === 'Enter') {
                analyzeNews();
            }
        });
    </script>
</body>
</html>
